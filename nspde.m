% NSPDE Project

dx1 = 0.05;
dt1 = 0.025;
dx2 = 0.02;
dt2 = 0.01;
dx3 = 0.01;
dt3 = 0.005;
dx4 = 0.05;
dt4 = 0.05;
dx5 = 0.02;
dt5 = 0.02;
dx6 = 0.01;
dt6 = 0.01;

p1 = 0;
p2 = 2/3;
p3 = 1;

sig = 0.01;

dx1sq = dx1*dx1;
dx2sq = dx2*dx2;
dx3sq = dx3*dx3;
dx4sq = dx4*dx4;
dx5sq = dx5*dx5;
dx6sq = dx6*dx6;
N  = 1/dx1;
N1 = 1/dx1; % number of elements
N2 = 1/dx2;
N3 = 1/dx3;
N4 = 1/dx4;
N5 = 1/dx5;
N6 = 1/dx6;

x1 = linspace(0,1,N1+1); % set up mesh
t1 = linspace(0,1,(N1*2)+1);
x2 = linspace(0,1,N2+1); % set up mesh
t2 = linspace(0,1,(N2*2)+1);
x3 = linspace(0,1,N3+1); % set up mesh
t3 = linspace(0,1,(N3*2)+1);
x4 = linspace(0,1,N4+1); % set up mesh
t4 = linspace(0,1,(N4)+1);
x5 = linspace(0,1,N5+1); % set up mesh
t5 = linspace(0,1,(N5)+1);
x6 = linspace(0,1,N6+1); % set up mesh
t6 = linspace(0,1,(N6)+1);


F1 = zeros(N1-1,N1-1);
U1 = zeros((N1*2)+1,N1+1);
V1 = zeros(N1-1,1);
FV1 = zeros(N1-1,1);
G1 = zeros(N1+1,1);
F2 = zeros(N2-1,N2-1);
U2 = zeros((N2*2)+1,N2+1);
V2 = zeros(N2-1,1);
FV2 = zeros(N2-1,1);
G2 = zeros(N2+1,1);
F3 = zeros(N3-1,N3-1);
U3 = zeros((N3*2)+1,N3+1);
V3 = zeros(N3-1,1);
FV3 = zeros(N3-1,1);
G3 = zeros(N3+1,1);
F4 = zeros(N4-1,N4-1);
U4 = zeros((N4)+1,N4+1);
V4 = zeros(N4-1,1);
FV4 = zeros(N4-1,1);
G4 = zeros(N4+1,1);
F5 = zeros(N5-1,N5-1); 
U5 = zeros((N5)+1,N5+1);
V5 = zeros(N5-1,1);
FV5 = zeros(N5-1,1);
G5 = zeros(N5+1,1);
F6 = zeros(N6-1,N6-1);
U6 = zeros((N6)+1,N6+1);
V6 = zeros(N6-1,1);
FV6 = zeros(N6-1,1);
G6 = zeros(N6+1,1);
F7 = zeros(N1-1,N1-1);
U7 = zeros((N1*2)+1,N1+1);
V7 = zeros(N1-1,1);
FV7 = zeros(N1-1,1);
G7 = zeros(N1+1,1);
F8 = zeros(N2-1,N2-1);
U8 = zeros((N2*2)+1,N2+1);
V8 = zeros(N2-1,1);
FV8 = zeros(N2-1,1);
G8 = zeros(N2+1,1);
F9 = zeros(N3-1,N3-1); 
U9 = zeros((N3*2)+1,N3+1);
V9 = zeros(N3-1,1);
FV9 = zeros(N3-1,1);
G9 = zeros(N3+1,1);
F10 = zeros(N4-1,N4-1);
U10 = zeros((N4)+1,N4+1);
V10 = zeros(N4-1,1);
FV10 = zeros(N4-1,1);
G10 = zeros(N4+1,1);
F11 = zeros(N5-1,N5-1); 
U11 = zeros((N5)+1,N5+1);
V11 = zeros(N5-1,1);
FV11 = zeros(N5-1,1);
G11 = zeros(N5+1,1);
F12 = zeros(N6-1,N6-1); 
U12 = zeros((N6)+1,N6+1);
V12 = zeros(N6-1,1);
FV12 = zeros(N6-1,1);
G12 = zeros(N6+1,1);
F13 = zeros(N1-1,N1-1); 
U13 = zeros((N1*2)+1,N1+1);
V13 = zeros(N1-1,1);
FV13 = zeros(N1-1,1);
G13 = zeros(N1+1,1);
F14 = zeros(N2-1,N2-1);
U14 = zeros((N2*2)+1,N2+1);
V14 = zeros(N2-1,1);
FV14 = zeros(N2-1,1);
G14 = zeros(N2+1,1);
F15 = zeros(N3-1,N3-1); 
U15 = zeros((N3*2)+1,N3+1);
V15 = zeros(N3-1,1);
FV15 = zeros(N3-1,1);
G15 = zeros(N3+1,1);
F16 = zeros(N4-1,N4-1);
U16 = zeros((N4)+1,N4+1);
V16 = zeros(N4-1,1);
FV16 = zeros(N4-1,1);
G16 = zeros(N4+1,1);
F17 = zeros(N5-1,N5-1);
U17 = zeros((N5)+1,N5+1);
V17 = zeros(N5-1,1);
FV17 = zeros(N5-1,1);
G17 = zeros(N5+1,1);
F18 = zeros(N6-1,N6-1); 
U18 = zeros((N6)+1,N6+1);
V18 = zeros(N6-1,1);
FV18 = zeros(N6-1,1);
G18 = zeros(N6+1,1);
S1 = zeros(N1-1,1);
S2 = zeros(N2-1,1);
S3 = zeros(N3-1,1);
S4 = zeros(N4-1,1);
S5 = zeros(N5-1,1);
S6 = zeros(N6-1,1);

for i=1:N1-1
V1(i) =   1 - tanh((x1(i+1) - dt1)/( 2* sig ));
S1(i) = 2;
S4(i) = 2;
V4(i) =   1 - tanh((x4(i+1) - dt4)/( 2* sig ));

V7(i) =   1 - tanh((x1(i+1) - dt1)/( 2* sig ));

V10(i) =  1 - tanh((x4(i+1) - dt4)/( 2* sig ));

V13(i) =  1 - tanh((x1(i+1) - dt1)/( 2* sig ));

V16(i) =  1 - tanh((x4(i+1) - dt4)/( 2* sig ));

end
for i=1:N2-1

V2(i) =   1 - tanh((x2(i+1) - dt2)/( 2* sig ));
S2(i) = 2;
S5(i) = 2;
V5(i) =   1 - tanh((x5(i+1) - dt5)/( 2* sig ));

V8(i) =   1 - tanh((x2(i+1) - dt2)/( 2* sig ));

V11(i) =  1 - tanh((x5(i+1) - dt5)/( 2* sig ));

V14(i) =  1 - tanh((x2(i+1) - dt2)/( 2* sig ));

V17(i) =  1 - tanh((x5(i+1) - dt5)/( 2* sig ));
end
for i=1:N3-1

V3(i) =   1 - tanh((x3(i+1) - dt3)/( 2* sig ));
S3(i) = 2;
S6(i) = 2;
V6(i) =   1 - tanh((x6(i+1) - dt6)/( 2* sig ));

V9(i) =   1 - tanh((x3(i+1) - dt3)/( 2* sig ));

V12(i) =  1 - tanh((x6(i+1) - dt6)/( 2* sig ));

V15(i) =  1 - tanh((x3(i+1) - dt3)/( 2* sig ));

V18(i) =  1 - tanh((x6(i+1) - dt6)/( 2* sig ));
end

for i=1:(N1*2)+1 % loop over elements
for j=1:N1+1 % loop over elements
if i == 1
U1(i+(((N1*2)+1)*(j-1)))  = 1 - tanh((x1(j) - t1(i))/( 2* sig ));

U7(i+(((N1*2)+1)*(j-1)))  = 1 - tanh((x1(j) - t1(i))/( 2* sig ));

U13(i+(((N1*2)+1)*(j-1))) = 1 - tanh((x1(j) - t1(i))/( 2* sig ));

elseif i == 2
U1(i+(((N1*2)+1)*(j-1)))  = 1 - tanh((x1(j) - t1(i))/( 2* sig ));

U7(i+(((N1*2)+1)*(j-1)))  = 1 - tanh((x1(j) - t1(i))/( 2* sig ));

U13(i+(((N1*2)+1)*(j-1))) = 1 - tanh((x1(j) - t1(i))/( 2* sig ));

else
U1(i+(((N1*2)+1)*(j-1)))  = 0 ; 

U7(i+(((N1*2)+1)*(j-1)))  = 0 ;

U13(i+(((N1*2)+1)*(j-1))) = 0 ;

end
end
U1(i)  =  1 - tanh((-1 * t1(i))/( 2* sig ));

U7(i)  =  1 - tanh((-1 * t1(i))/( 2* sig ));

U13(i) =  1 - tanh((-1 * t1(i))/( 2* sig ));

%disp(U(i+ (((N*2)+ 1)*(N))));
U1(i+ (((N1*2)+ 1)*(N1)))  = 1 - tanh((1 - t1(i))/( 2* sig ));

U7(i+ (((N1*2)+ 1)*(N1)))  = 1 - tanh((1 - t1(i))/( 2* sig ));

U13(i+ (((N1*2)+ 1)*(N1))) = 1 - tanh((1 - t1(i))/( 2* sig ));
%disp(U1);
end

for i=1:(N2*2)+1 % loop over elements
for j=1:N2+1 % loop over elements
if i == 1

U2(i+(((N2*2)+1)*(j-1)))  = 1 - tanh((x2(j) - t2(i))/( 2* sig ));

U8(i+(((N2*2)+1)*(j-1)))  = 1 - tanh((x2(j) - t2(i))/( 2* sig ));

U14(i+(((N2*2)+1)*(j-1))) = 1 - tanh((x2(j) - t2(i))/( 2* sig ));

elseif i == 2

U2(i+(((N2*2)+1)*(j-1)))  = 1 - tanh((x2(j) - t2(i))/( 2* sig ));

U8(i+(((N2*2)+1)*(j-1)))  = 1 - tanh((x2(j) - t2(i))/( 2* sig ));

U14(i+(((N2*2)+1)*(j-1))) = 1 - tanh((x2(j) - t2(i))/( 2* sig ));

else

U2(i+(((N2*2)+1)*(j-1)))  = 0 ;

U8(i+(((N2*2)+1)*(j-1)))  = 0 ;

U14(i+(((N2*2)+1)*(j-1))) = 0 ;

end
end

U2(i)  =  1 - tanh((-1 * t2(i))/( 2* sig ));

U8(i)  =  1 - tanh((-1 * t2(i))/( 2* sig ));

U14(i) =  1 - tanh((-1 * t2(i))/( 2* sig ));

%disp(U(i+ (((N*2)+ 1)*(N))));

U2(i+ (((N2*2)+ 1)*(N2)))  = 1 - tanh((1 - t2(i))/( 2* sig ));

U8(i+ (((N2*2)+ 1)*(N2)))  = 1 - tanh((1 - t2(i))/( 2* sig ));

U14(i+ (((N2*2)+ 1)*(N2))) = 1 - tanh((1 - t2(i))/( 2* sig ));

end

for i=1:(N3*2)+1 % loop over elements
for j=1:N3+1 % loop over elements
if i == 1

U3(i+(((N3*2)+1)*(j-1)))  = 1 - tanh((x3(j) - t3(i))/( 2* sig ));

U9(i+(((N3*2)+1)*(j-1)))  = 1 - tanh((x3(j) - t3(i))/( 2* sig ));

U15(i+(((N3*2)+1)*(j-1))) = 1 - tanh((x3(j) - t3(i))/( 2* sig ));
elseif i == 2

U3(i+(((N3*2)+1)*(j-1)))  = 1 - tanh((x3(j) - t3(i))/( 2* sig ));

U9(i+(((N3*2)+1)*(j-1)))  = 1 - tanh((x3(j) - t3(i))/( 2* sig ));

U15(i+(((N3*2)+1)*(j-1))) = 1 - tanh((x3(j) - t3(i))/( 2* sig ));
else

U3(i+(((N3*2)+1)*(j-1)))  = 0 ;

U9(i+(((N3*2)+1)*(j-1)))  = 0 ;

U15(i+(((N3*2)+1)*(j-1))) = 0 ;
end
end

U3(i)  =  1 - tanh((-1 * t3(i))/( 2* sig ));

U9(i)  =  1 - tanh((-1 * t3(i))/( 2* sig ));

U15(i) =  1 - tanh((-1 * t3(i))/( 2* sig ));
%disp(U(i+ (((N*2)+ 1)*(N))));

U3(i+ (((N3*2)+ 1)*(N3)))  = 1 - tanh((1 - t3(i))/( 2* sig ));

U9(i+ (((N3*2)+ 1)*(N3)))  = 1 - tanh((1 - t3(i))/( 2* sig ));

U15(i+ (((N3*2)+ 1)*(N3))) = 1 - tanh((1 - t3(i))/( 2* sig ));
end
%disp(U);
for i=1:N1+1 % loop over elements
for j=1:N1+1 % loop over elements
if i == 1
U4(i+(((N1)+1)*(j-1)))   = 1 - tanh((x4(j) - t4(i))/( 2* sig ));

U10(i+(((N1)+1)*(j-1)))  = 1 - tanh((x4(j) - t4(i))/( 2* sig ));

U16(i+(((N1)+1)*(j-1)))  = 1 - tanh((x4(j) - t4(i))/( 2* sig ));

elseif i == 2
U4(i+(((N1)+1)*(j-1)))   = 1 - tanh((x4(j) - t4(i))/( 2* sig ));

U10(i+(((N1)+1)*(j-1)))  = 1 - tanh((x4(j) - t4(i))/( 2* sig ));

U16(i+(((N1)+1)*(j-1)))  = 1 - tanh((x4(j) - t4(i))/( 2* sig ));

else
U4(i+(((N1)+1)*(j-1)))   = 0 ; 

U10(i+(((N1)+1)*(j-1)))  = 0 ;

U16(i+(((N1)+1)*(j-1)))  = 0 ;

end
end
U4(i)   =  1 - tanh((-1 * t4(i))/( 2* sig ));

U10(i)  =  1 - tanh((-1 * t4(i))/( 2* sig ));

U16(i)  =  1 - tanh((-1 * t4(i))/( 2* sig ));

%disp(U(i+ (((N*2)+ 1)*(N))));
U4(i+ (((N1)+ 1)*(N1)))   = 1 - tanh((1 - t4(i))/( 2* sig ));

U10(i+ (((N1)+ 1)*(N1)))  = 1 - tanh((1 - t4(i))/( 2* sig ));

U16(i+ (((N1)+ 1)*(N1)))  = 1 - tanh((1 - t4(i))/( 2* sig ));

end

for i=1:N2+1 % loop over elements
for j=1:N2+1 % loop over elements
if i == 1

U5(i+(((N2)+1)*(j-1)))   = 1 - tanh((x5(j) - t5(i))/( 2* sig ));

U11(i+(((N2)+1)*(j-1)))  = 1 - tanh((x5(j) - t5(i))/( 2* sig ));

U17(i+(((N2)+1)*(j-1)))  = 1 - tanh((x5(j) - t5(i))/( 2* sig ));

elseif i == 2

U5(i+(((N2)+1)*(j-1)))   = 1 - tanh((x5(j) - t5(i))/( 2* sig ));

U11(i+(((N2)+1)*(j-1)))  = 1 - tanh((x5(j) - t5(i))/( 2* sig ));

U17(i+(((N2)+1)*(j-1)))  = 1 - tanh((x5(j) - t5(i))/( 2* sig ));

else
 
U5(i+(((N2)+1)*(j-1)))   = 0 ;

U11(i+(((N2)+1)*(j-1)))  = 0 ;

U17(i+(((N2)+1)*(j-1)))  = 0 ;

end
end

U5(i)   =  1 - tanh((-1 * t5(i))/( 2* sig ));

U11(i)  =  1 - tanh((-1 * t5(i))/( 2* sig ));

U17(i)  =  1 - tanh((-1 * t5(i))/( 2* sig ));

%disp(U(i+ (((N*2)+ 1)*(N))));

U5(i+ (((N2)+ 1)*(N2)))   = 1 - tanh((1 - t5(i))/( 2* sig ));

U11(i+ (((N2)+ 1)*(N2)))  = 1 - tanh((1 - t5(i))/( 2* sig ));

U17(i+ (((N2)+ 1)*(N2)))  = 1 - tanh((1 - t5(i))/( 2* sig ));

end


for i=1:N3+1 % loop over elements
for j=1:N3+1 % loop over elements
if i == 1

U6(i+(((N3)+1)*(j-1)))   = 1 - tanh((x6(j) - t6(i))/( 2* sig ));

U12(i+(((N3)+1)*(j-1)))  = 1 - tanh((x6(j) - t6(i))/( 2* sig ));

U18(i+(((N3)+1)*(j-1)))  = 1 - tanh((x6(j) - t6(i))/( 2* sig ));
elseif i == 2

U6(i+(((N3)+1)*(j-1)))   = 1 - tanh((x6(j) - t6(i))/( 2* sig ));

U12(i+(((N3)+1)*(j-1)))  = 1 - tanh((x6(j) - t6(i))/( 2* sig ));

U18(i+(((N3)+1)*(j-1)))  = 1 - tanh((x6(j) - t6(i))/( 2* sig ));
else

U6(i+(((N3)+1)*(j-1)))   = 0 ;

U12(i+(((N3)+1)*(j-1)))  = 0 ;

U18(i+(((N3)+1)*(j-1)))  = 0 ;
end
end

U6(i)   =  1 - tanh((-1 * t6(i))/( 2* sig ));

U12(i)  =  1 - tanh((-1 * t6(i))/( 2* sig ));

U18(i)  =  1 - tanh((-1 * t6(i))/( 2* sig ));
%disp(U(i+ (((N*2)+ 1)*(N))));

U6(i+ (((N3)+ 1)*(N3)))   = 1 - tanh((1 - t6(i))/( 2* sig ));

U12(i+ (((N3)+ 1)*(N3)))  = 1 - tanh((1 - t6(i))/( 2* sig ));

U18(i+ (((N3)+ 1)*(N3)))  = 1 - tanh((1 - t6(i))/( 2* sig ));
end


for k=1:((N1*2)-1)
for i=1:N1-1 % loop over elements
for j=1:N1-1
if i == j
F1((i*(N1) - (N1-1)))  = 1 + ((dt1/(2*dx1))*(((1-p1)/4)*(U1((k+1)+(((N1*2)+1)*(j+1)))  + U1((k)+(((N1*2)+1)*(j+1)))  - U1((k+1)+(((N1*2)+1)*(j-1)))  - U1((k)+(((N1*2)+1)*(j-1))))))  + ((dt1 * sig)/dx1sq) ;

F7((i*(N1) - (N1-1)))  = 1 + (dt1/(2*dx1))*(((1-p2)/4)*(U7((k+1)+(((N1*2)+1)*(j+1)))  + U7((k)+(((N1*2)+1)*(j+1)))  - U7((k+1)+(((N1*2)+1)*(j-1)))  - U7((k)+(((N1*2)+1)*(j-1)))))  + ((dt1 * sig)/dx1sq) ;

F13((i*(N1) - (N1-1))) = 1 + (dt1/(2*dx1))*(((1-p3)/4)*(U13((k+1)+(((N1*2)+1)*(j+1))) + U13((k)+(((N1*2)+1)*(j+1))) - U13((k+1)+(((N1*2)+1)*(j-1))) - U13((k)+(((N1*2)+1)*(j-1))))) + ((dt1 * sig)/dx1sq) ;

%                    1 + (dt/(2*dx))*(((1-p)/4)*(un1j1 + unj1 - un11j - un1j)) + ((dt * sig)/dxsq) ;
%disp(F(1));
elseif i == j + 1 && k ~= 1
F1(i + ((N1-1)*(j-1)))  = ((dt1/(2*dx1))*((((p1)/8)*((2*U1((k)+(((N1*2)+1)*(j))))  + (2*U1((k-1)+(((N1*2)+1)*(j))))))  + (((1-p1)/4)*( U1((k)+(((N1*2)+1)*(j-1)))  + U1((k-1)+(((N1*2)+1)*(j-1))))) )  - ((dt1 * sig)/(dx1sq * 2))) * 1 ;

F7(i + ((N1-1)*(j-1)))  = ((dt1/(2*dx1))*((((p2)/8)*((2*U7((k+1)+(((N1*2)+1)*(j))))  + (2*U7((k)+(((N1*2)+1)*(j))))))  + (((1-p2)/4)*( U7((k+1)+(((N1*2)+1)*(j-1)))  + U7((k)+(((N1*2)+1)*(j-1))))) )  - ((dt1 * sig)/(dx1sq * 2))) * 1 ;

F13(i + ((N1-1)*(j-1))) = ((dt1/(2*dx1))*((((p3)/8)*((2*U13((k+1)+(((N1*2)+1)*(j)))) + (2*U13((k)+(((N1*2)+1)*(j)))))) + (((1-p3)/4)*( U13((k+1)+(((N1*2)+1)*(j-1))) + U13((k)+(((N1*2)+1)*(j-1))))) ) - ((dt1 * sig)/(dx1sq * 2))) * 1 ;
%                   ((dt/(2*dx))*((((p)/8)*((2*un1j1) + (2*unj1))) + (((1-p)/4)*( un1j + unj)) ) - ((dt * sig)/(dxsq * 2))) * -1 ;
elseif i + 1 == j
F1(i + ((N1-1)*(j-1)))  = ((dt1/(2*dx1))*((((p1)/8)*((2*U1((k)+(((N1*2)+1)*(j))))  + (2*U1((k)+(((N1*2)+1)*(j))))))  + (((1-p1)/4)*( U1((k+1)+(((N1*2)+1)*(j+1)))  + U1((k+1)+(((N1*2)+1)*(j+1))))) )  + ((dt1 * sig)/(dx1sq * 2))) * -1 ;

F7(i + ((N1-1)*(j-1)) )  = ((dt1/(2*dx1))*((((p2)/8)*((2*U7((k+1)+(((N1*2)+1)*(j))))  + (2*U7((k)+(((N1*2)+1)*(j))))))  + (((1-p2)/4)*( U7((k+1)+(((N1*2)+1)*(j+1)))  + U7((k)+(((N1*2)+1)*(j+1))))) )  + ((dt1 * sig)/(dx1sq * 2))) * -1 ;

F13(i + ((N1-1)*(j-1)) ) = ((dt1/(2*dx1))*((((p3)/8)*((2*U13((k+1)+(((N1*2)+1)*(j)))) + (2*U13((k)+(((N1*2)+1)*(j)))))) + (((1-p3)/4)*( U13((k+1)+(((N1*2)+1)*(j+1))) + U13((k)+(((N1*2)+1)*(j+1))))) ) + ((dt1 * sig)/(dx1sq * 2))) * -1 ;

%                   (dt/(2*dx))*((((p)/8)*((2*un1j1) + (2*unj1))) + (((1-p)/4)*( un1j + unj)) ) - ((dt * sig)/(dxsq * 2)) ;
else
%F() = 0;
end
end
%FV(i) = U((i+1)+(N+1))+ U((i)+(N+1))+ (dt/(2*dx))*((((p)/8)*((U((i+1)+((N+1)*(2)))*U((i+1)+((N+1)*(2)))) + (U((i)+((N+1)*(2)))*U((i)+((N+1)*(2))))+ (U((i+1)+((N+1)*(2)))*2*U((i)+((N+1)*(2))))-(U((i+1)+((N+1)*(0)))*U((i+1)+((N+1)*(0)))) - (U((i)+((N+1)*(0)))*U((i)+((N+1)*(0))))+ (U((i+1)+((N+1)*(0)))*2*U((i)+((N+1)*(0))))))+ (((1-p)/4)*( (U((i+1)+((N+1)*(1)))*U((i+1)+((N+1)*(2)))) + (U((i+1)+((N+1)*(1)))*U((i)+((N+1)*(2))))-(U((i+1)+((N+1)*(1)))*U((i+1)+((N+1)*(0)))) - (U((i+1)+((N+1)*(1)))*U((i)+((N+1)*(0))))+(U((i)+((N+1)*(1)))*U((i+1)+((N+1)*(2)))) + (U((i)+((N+1)*(1)))*U((i)+((N+1)*(2))))-(U((i)+((N+1)*(1)))*U((i+1)+((N+1)*(0)))) - (U((i)+((N+1)*(1)))*U((i)+((N+1)*(0)))))))-((dt*sig)/dxsq)*(((U((i+1)+((N+1)*(2))) + U((i)+((N+1)*(2))))/2) - (U((i+1)+((N+1)*(1))) + U((i+1)+((N+1)*(1))))+ ((U((i+1)+((N+1)*(0)))+U((i+1)+((N+1)*(0))))/2));
disp(F1);
end

for i=1:N1-1
 
A1  = U1((k+1)+(((N1*2)+1)*i)) + U1((k)+(((N1*2)+1)*i));
A7  = U7((k+1)+(((N1*2)+1)*i)) + U7((k)+(((N1*2)+1)*i));
A13 = U13((k+1)+(((N1*2)+1)*i))+ U13((k)+(((N1*2)+1)*i));

B1  = (dt1/(2*dx1))*((((p1)/8)*((U1((k+1)+(((N1*2)+1)*(i+1))) *U1((k+1)+(((N1*2)+1)*(i+1))))  + (U1((k)+(((N1*2)+1)*(i+1))) *U1((k)+(((N1*2)+1)*(i+1)))) + (U1((k+1)+(((N1*2)+1)*(i+1)))*2 *U1((k)+(((N1*2)+1)*(i+1)))) -(U1((k+1)+(((N1*2)+1)*(i-1))) *U1((k+1)+(((N1*2)+1)*(i-1))))  - (U1((k)+(((N1*2)+1)*(i-1))) *U1((k)+(((N1*2)+1)*(i-1))))  - (U1((k+1)+(((N1*2)+1)*(i-1)))*2 *U1((k)+(((N1*2)+1)*(i-1))))))  + (((1-p1)/4)*( (U1((k+1)+(((N1*2)+1)*(i))) *U1((k+1)+(((N1*2)+1)*(i+1))))  + (U1((k+1)+(((N1*2)+1)*(i))) *U1((k)+(((N1*2)+1)*(i+1)))) -(U1((k+1)+(((N1*2)+1)*(i))) *U1((k+1)+(((N1*2)+1)*(i-1))))  - (U1((k+1)+(((N1*2)+1)*(i))) *U1((k)+(((N1*2)+1)*(i-1)))) +(U1((k)+(((N1*2)+1)*(i))) *U1((k+1)+(((N1*2)+1)*(i+1))))  + (U1((k)+(((N1*2)+1)*(i))) *U1((k)+(((N1*2)+1)*(i+1)))) -(U1((k)+(((N1*2)+1)*(i))) *U1((k+1)+(((N1*2)+1)*(i-1))))  - (U1((k)+(((N1*2)+1)*(i))) *U1((k)+(((N1*2)+1)*(i-1)))))));
B7  = (dt1/(2*dx1))*((((p2)/8)*((U7((k+1)+(((N1*2)+1)*(i+1))) *U7((k+1)+(((N1*2)+1)*(i+1))))  + (U7((k)+(((N1*2)+1)*(i+1))) *U7((k)+(((N1*2)+1)*(i+1)))) + (U7((k+1)+(((N1*2)+1)*(i+1)))*2 *U7((k)+(((N1*2)+1)*(i+1)))) -(U7((k+1)+(((N1*2)+1)*(i-1))) *U7((k+1)+(((N1*2)+1)*(i-1))))  - (U7((k)+(((N1*2)+1)*(i-1))) *U7((k)+(((N1*2)+1)*(i-1))))  - (U7((k+1)+(((N1*2)+1)*(i-1)))*2 *U7((k)+(((N1*2)+1)*(i-1))))))  + (((1-p2)/4)*( (U7((k+1)+(((N1*2)+1)*(i))) *U7((k+1)+(((N1*2)+1)*(i+1))))  + (U7((k+1)+(((N1*2)+1)*(i))) *U7((k)+(((N1*2)+1)*(i+1)))) -(U7((k+1)+(((N1*2)+1)*(i))) *U7((k+1)+(((N1*2)+1)*(i-1))))  - (U7((k+1)+(((N1*2)+1)*(i))) *U7((k)+(((N1*2)+1)*(i-1)))) +(U7((k)+(((N1*2)+1)*(i))) *U7((k+1)+(((N1*2)+1)*(i+1))))  + (U7((k)+(((N1*2)+1)*(i))) *U7((k)+(((N1*2)+1)*(i+1)))) -(U7((k)+(((N1*2)+1)*(i))) *U7((k+1)+(((N1*2)+1)*(i-1))))  - (U7((k)+(((N1*2)+1)*(i))) *U7((k)+(((N1*2)+1)*(i-1)))))));
B13 = (dt1/(2*dx1))*((((p3)/8)*((U13((k+1)+(((N1*2)+1)*(i+1)))*U13((k+1)+(((N1*2)+1)*(i+1)))) + (U13((k)+(((N1*2)+1)*(i+1)))*U13((k)+(((N1*2)+1)*(i+1))))+ (U13((k+1)+(((N1*2)+1)*(i+1)))*2*U13((k)+(((N1*2)+1)*(i+1))))-(U13((k+1)+(((N1*2)+1)*(i-1)))*U13((k+1)+(((N1*2)+1)*(i-1)))) - (U13((k)+(((N1*2)+1)*(i-1)))*U13((k)+(((N1*2)+1)*(i-1)))) - (U13((k+1)+(((N1*2)+1)*(i-1)))*2*U13((k)+(((N1*2)+1)*(i-1)))))) + (((1-p3)/4)*( (U13((k+1)+(((N1*2)+1)*(i)))*U13((k+1)+(((N1*2)+1)*(i+1)))) + (U13((k+1)+(((N1*2)+1)*(i)))*U13((k)+(((N1*2)+1)*(i+1))))-(U13((k+1)+(((N1*2)+1)*(i)))*U13((k+1)+(((N1*2)+1)*(i-1)))) - (U13((k+1)+(((N1*2)+1)*(i)))*U13((k)+(((N1*2)+1)*(i-1))))+(U13((k)+(((N1*2)+1)*(i)))*U13((k+1)+(((N1*2)+1)*(i+1)))) + (U13((k)+(((N1*2)+1)*(i)))*U13((k)+(((N1*2)+1)*(i+1))))-(U13((k)+(((N1*2)+1)*(i)))*U13((k+1)+(((N1*2)+1)*(i-1)))) - (U13((k)+(((N1*2)+1)*(i)))*U13((k)+(((N1*2)+1)*(i-1)))))));

C1  = (((dt1*sig)/dx1sq)*(((U1((k+1)+(((N1*2)+1)*(i+1)))  + U1((k)+(((N1*2)+1)*(i+1))))/2)  - (U1((k+1)+(((N1*2)+1)*(i)))  + U1((k+1)+(((N1*2)+1)*(i)))) + ((U1((k+1)+(((N1*2)+1)*(i-1))) +U1((k+1)+(((N1*2)+1)*(i-1))))/2)));
C7  = (((dt1*sig)/dx1sq)*(((U7((k+1)+(((N1*2)+1)*(i+1)))  + U7((k)+(((N1*2)+1)*(i+1))))/2)  - (U7((k+1)+(((N1*2)+1)*(i)))  + U7((k+1)+(((N1*2)+1)*(i)))) + ((U7((k+1)+(((N1*2)+1)*(i-1))) +U7((k+1)+(((N1*2)+1)*(i-1))))/2)));
C13 = (((dt1*sig)/dx1sq)*(((U13((k+1)+(((N1*2)+1)*(i+1))) + U13((k)+(((N1*2)+1)*(i+1))))/2) - (U13((k+1)+(((N1*2)+1)*(i))) + U13((k+1)+(((N1*2)+1)*(i))))+ ((U13((k+1)+(((N1*2)+1)*(i-1)))+U13((k+1)+(((N1*2)+1)*(i-1))))/2)));


FV1(i)  = A1  + B1  - C1;
FV7(i)  = A7  + B7  - C7;
FV13(i) = A13 + B13 - C13;
% fprintf ( 1, '\n' );
% disp(A);
% disp(B);
% disp(C);
% disp(FV(i));
% fprintf ( 1, '\n' );
end
 %V = F/U;
%disp(FV);
 %disp(V);
V1  = (F1)  \ ((F1  * V1)  - FV1) ;
V7  = (F7)  \ ((F7  * V7)  - FV7) ;
V13 = (F13) \ ((F13 * V13) - FV13) ;

%disp(V);
for i=1:N1-1
%disp((k+2)+((N+1)*(i)));
U1((k+2)+(((N1*2)+1)*(i)))  = V1(i);
U7((k+2)+(((N1*2)+1)*(i)))  = V7(i);
U13((k+2)+(((N1*2)+1)*(i))) = V13(i);
end
disp(U1);
%V = mldivide(((mtimes(F,V)) - FV), F) ;
end

for k=1:((N2*2)-1)
for i=1:N2-1 % loop over elements
for j=1:N2-1
if i == j
F2((i*(N2) - (N2-1)))  = 1 + (dt2/(2*dx2))*(((1-p1)/4)*(U2((k+1)+(((N2*2)+1)*(j+1)))  + U2((k)+(((N2*2)+1)*(j+1)))  - U2((k+1)+(((N2*2)+1)*(j-1)))  - U2((k)+(((N2*2)+1)*(j-1)))))  + ((dt2 * sig)/dx2sq) ;
F8((i*(N2) - (N2-1)))  = 1 + (dt2/(2*dx2))*(((1-p2)/4)*(U8((k+1)+(((N2*2)+1)*(j+1)))  + U8((k)+(((N2*2)+1)*(j+1)))  - U8((k+1)+(((N2*2)+1)*(j-1)))  - U8((k)+(((N2*2)+1)*(j-1)))))  + ((dt2 * sig)/dx2sq) ;
F14((i*(N2) - (N2-1))) = 1 + (dt2/(2*dx2))*(((1-p3)/4)*(U14((k+1)+(((N2*2)+1)*(j+1))) + U14((k)+(((N2*2)+1)*(j+1))) - U14((k+1)+(((N2*2)+1)*(j-1))) - U14((k)+(((N2*2)+1)*(j-1))))) + ((dt2 * sig)/dx2sq) ;

%                    1 + (dt/(2*dx))*(((1-p)/4)*(un1j1 + unj1 - un11j - un1j)) + ((dt * sig)/dxsq) ;
%disp(F(1));
elseif i == j + 1
F2(2 + (N2* (i-2)))  = ((dt2/(2*dx2))*((((p1)/8)*((2*U2((k+1)+(((N2*2)+1)*(j))))  + (2*U2((k)+(((N2*2)+1)*(j))))))  + (((1-p1)/4)*( U2((k+1)+(((N2*2)+1)*(j-1)))  + U2((k)+(((N2*2)+1)*(j-1))))) )  - ((dt2 * sig)/(dx2sq * 2))) * 1 ;
F8(2 + (N2* (i-2)))  = ((dt2/(2*dx2))*((((p2)/8)*((2*U8((k+1)+(((N2*2)+1)*(j))))  + (2*U8((k)+(((N2*2)+1)*(j))))))  + (((1-p2)/4)*( U8((k+1)+(((N2*2)+1)*(j-1)))  + U8((k)+(((N2*2)+1)*(j-1))))) )  - ((dt2 * sig)/(dx2sq * 2))) * 1 ;
F14(2 + (N2* (i-2))) = ((dt2/(2*dx2))*((((p3)/8)*((2*U14((k+1)+(((N2*2)+1)*(j)))) + (2*U14((k)+(((N2*2)+1)*(j)))))) + (((1-p3)/4)*( U14((k+1)+(((N2*2)+1)*(j-1))) + U14((k)+(((N2*2)+1)*(j-1))))) ) - ((dt2 * sig)/(dx2sq * 2))) * 1 ;
%                   ((dt/(2*dx))*((((p)/8)*((2*un1j1) + (2*unj1))) + (((1-p)/4)*( un1j + unj)) ) - ((dt * sig)/(dxsq * 2))) * -1 ;
elseif i + 1 == j
F2(N2 + (N2* (i-1)))  = ((dt2/(2*dx2))*((((p1)/8)*((2*U2((k+1)+(((N2*2)+1)*(j))))  + (2*U2((k)+(((N2*2)+1)*(j))))))  + (((1-p1)/4)*( U2((k+1)+(((N2*2)+1)*(j+1)))  + U2((k)+(((N2*2)+1)*(j+1))))) )  + ((dt2 * sig)/(dx2sq * 2))) * -1 ;
F8(N2 + (N2* (i-1)))  = ((dt2/(2*dx2))*((((p2)/8)*((2*U8((k+1)+(((N2*2)+1)*(j))))  + (2*U8((k)+(((N2*2)+1)*(j))))))  + (((1-p2)/4)*( U8((k+1)+(((N2*2)+1)*(j+1)))  + U8((k)+(((N2*2)+1)*(j+1))))) )  + ((dt2 * sig)/(dx2sq * 2))) * -1 ;
F14(N2 + (N2* (i-1))) = ((dt2/(2*dx2))*((((p3)/8)*((2*U14((k+1)+(((N2*2)+1)*(j)))) + (2*U14((k)+(((N2*2)+1)*(j)))))) + (((1-p3)/4)*( U14((k+1)+(((N2*2)+1)*(j+1))) + U14((k)+(((N2*2)+1)*(j+1))))) ) + ((dt2 * sig)/(dx2sq * 2))) * -1 ;

%                   (dt/(2*dx))*((((p)/8)*((2*un1j1) + (2*unj1))) + (((1-p)/4)*( un1j + unj)) ) - ((dt * sig)/(dxsq * 2)) ;
else
%F() = 0;
end
end
%FV(i) = U((i+1)+(N+1))+ U((i)+(N+1))+ (dt/(2*dx))*((((p)/8)*((U((i+1)+((N+1)*(2)))*U((i+1)+((N+1)*(2)))) + (U((i)+((N+1)*(2)))*U((i)+((N+1)*(2))))+ (U((i+1)+((N+1)*(2)))*2*U((i)+((N+1)*(2))))-(U((i+1)+((N+1)*(0)))*U((i+1)+((N+1)*(0)))) - (U((i)+((N+1)*(0)))*U((i)+((N+1)*(0))))+ (U((i+1)+((N+1)*(0)))*2*U((i)+((N+1)*(0))))))+ (((1-p)/4)*( (U((i+1)+((N+1)*(1)))*U((i+1)+((N+1)*(2)))) + (U((i+1)+((N+1)*(1)))*U((i)+((N+1)*(2))))-(U((i+1)+((N+1)*(1)))*U((i+1)+((N+1)*(0)))) - (U((i+1)+((N+1)*(1)))*U((i)+((N+1)*(0))))+(U((i)+((N+1)*(1)))*U((i+1)+((N+1)*(2)))) + (U((i)+((N+1)*(1)))*U((i)+((N+1)*(2))))-(U((i)+((N+1)*(1)))*U((i+1)+((N+1)*(0)))) - (U((i)+((N+1)*(1)))*U((i)+((N+1)*(0)))))))-((dt*sig)/dxsq)*(((U((i+1)+((N+1)*(2))) + U((i)+((N+1)*(2))))/2) - (U((i+1)+((N+1)*(1))) + U((i+1)+((N+1)*(1))))+ ((U((i+1)+((N+1)*(0)))+U((i+1)+((N+1)*(0))))/2));
end
%disp(F);
for i=1:N2-1
 
A2  = U2((k+1)+(((N2*2)+1)*i)) + U2((k)+(((N2*2)+1)*i));
A8  = U8((k+1)+(((N2*2)+1)*i)) + U8((k)+(((N2*2)+1)*i));
A14 = U14((k+1)+(((N2*2)+1)*i))+ U14((k)+(((N2*2)+1)*i));

B2  = (dt2/(2*dx2))*((((p1)/8)*((U2((k+1)+(((N2*2)+1)*(i+1))) *U2((k+1)+(((N2*2)+1)*(i+1))))  + (U2((k)+(((N2*2)+1)*(i+1))) *U2((k)+(((N2*2)+1)*(i+1)))) + (U2((k+1)+(((N2*2)+1)*(i+1)))*2 *U2((k)+(((N2*2)+1)*(i+1)))) -(U2((k+1)+(((N2*2)+1)*(i-1))) *U2((k+1)+(((N2*2)+1)*(i-1))))  - (U2((k)+(((N2*2)+1)*(i-1))) *U2((k)+(((N2*2)+1)*(i-1))))  - (U2((k+1)+(((N2*2)+1)*(i-1)))*2 *U2((k)+(((N2*2)+1)*(i-1))))))  + (((1-p1)/4)*( (U2((k+1)+(((N2*2)+1)*(i))) *U2((k+1)+(((N2*2)+1)*(i+1))))  + (U2((k+1)+(((N2*2)+1)*(i))) *U2((k)+(((N2*2)+1)*(i+1)))) -(U2((k+1)+(((N2*2)+1)*(i))) *U2((k+1)+(((N2*2)+1)*(i-1))))  - (U2((k+1)+(((N2*2)+1)*(i))) *U2((k)+(((N2*2)+1)*(i-1)))) +(U2((k)+(((N2*2)+1)*(i))) *U2((k+1)+(((N2*2)+1)*(i+1))))  + (U2((k)+(((N2*2)+1)*(i))) *U2((k)+(((N2*2)+1)*(i+1)))) -(U2((k)+(((N2*2)+1)*(i))) *U2((k+1)+(((N2*2)+1)*(i-1))))  - (U2((k)+(((N2*2)+1)*(i))) *U2((k)+(((N2*2)+1)*(i-1)))))));
B8  = (dt2/(2*dx2))*((((p2)/8)*((U8((k+1)+(((N2*2)+1)*(i+1))) *U8((k+1)+(((N2*2)+1)*(i+1))))  + (U8((k)+(((N2*2)+1)*(i+1))) *U8((k)+(((N2*2)+1)*(i+1)))) + (U8((k+1)+(((N2*2)+1)*(i+1)))*2 *U8((k)+(((N2*2)+1)*(i+1)))) -(U8((k+1)+(((N2*2)+1)*(i-1))) *U8((k+1)+(((N2*2)+1)*(i-1))))  - (U8((k)+(((N2*2)+1)*(i-1))) *U8((k)+(((N2*2)+1)*(i-1))))  - (U8((k+1)+(((N2*2)+1)*(i-1)))*2 *U8((k)+(((N2*2)+1)*(i-1))))))  + (((1-p2)/4)*( (U8((k+1)+(((N2*2)+1)*(i))) *U8((k+1)+(((N2*2)+1)*(i+1))))  + (U8((k+1)+(((N2*2)+1)*(i))) *U8((k)+(((N2*2)+1)*(i+1)))) -(U8((k+1)+(((N2*2)+1)*(i))) *U8((k+1)+(((N2*2)+1)*(i-1))))  - (U8((k+1)+(((N2*2)+1)*(i))) *U8((k)+(((N2*2)+1)*(i-1)))) +(U8((k)+(((N2*2)+1)*(i))) *U8((k+1)+(((N2*2)+1)*(i+1))))  + (U8((k)+(((N2*2)+1)*(i))) *U8((k)+(((N2*2)+1)*(i+1)))) -(U8((k)+(((N2*2)+1)*(i))) *U8((k+1)+(((N2*2)+1)*(i-1))))  - (U8((k)+(((N2*2)+1)*(i))) *U8((k)+(((N2*2)+1)*(i-1)))))));
B14 = (dt2/(2*dx2))*((((p3)/8)*((U14((k+1)+(((N2*2)+1)*(i+1)))*U14((k+1)+(((N2*2)+1)*(i+1)))) + (U14((k)+(((N2*2)+1)*(i+1)))*U14((k)+(((N2*2)+1)*(i+1))))+ (U14((k+1)+(((N2*2)+1)*(i+1)))*2*U14((k)+(((N2*2)+1)*(i+1))))-(U14((k+1)+(((N2*2)+1)*(i-1)))*U14((k+1)+(((N2*2)+1)*(i-1)))) - (U14((k)+(((N2*2)+1)*(i-1)))*U14((k)+(((N2*2)+1)*(i-1)))) - (U14((k+1)+(((N2*2)+1)*(i-1)))*2*U14((k)+(((N2*2)+1)*(i-1)))))) + (((1-p3)/4)*( (U14((k+1)+(((N2*2)+1)*(i)))*U14((k+1)+(((N2*2)+1)*(i+1)))) + (U14((k+1)+(((N2*2)+1)*(i)))*U14((k)+(((N2*2)+1)*(i+1))))-(U14((k+1)+(((N2*2)+1)*(i)))*U14((k+1)+(((N2*2)+1)*(i-1)))) - (U14((k+1)+(((N2*2)+1)*(i)))*U14((k)+(((N2*2)+1)*(i-1))))+(U14((k)+(((N2*2)+1)*(i)))*U14((k+1)+(((N2*2)+1)*(i+1)))) + (U14((k)+(((N2*2)+1)*(i)))*U14((k)+(((N2*2)+1)*(i+1))))-(U14((k)+(((N2*2)+1)*(i)))*U14((k+1)+(((N2*2)+1)*(i-1)))) - (U14((k)+(((N2*2)+1)*(i)))*U14((k)+(((N2*2)+1)*(i-1)))))));

C2  = (((dt2*sig)/dx2sq)*(((U2((k+1)+(((N2*2)+1)*(i+1)))  + U2((k)+(((N2*2)+1)*(i+1))))/2)  - (U2((k+1)+(((N2*2)+1)*(i)))  + U2((k+1)+(((N2*2)+1)*(i)))) + ((U2((k+1)+(((N2*2)+1)*(i-1))) +U2((k+1)+(((N2*2)+1)*(i-1))))/2)));
C8  = (((dt2*sig)/dx2sq)*(((U8((k+1)+(((N2*2)+1)*(i+1)))  + U8((k)+(((N2*2)+1)*(i+1))))/2)  - (U8((k+1)+(((N2*2)+1)*(i)))  + U8((k+1)+(((N2*2)+1)*(i)))) + ((U8((k+1)+(((N2*2)+1)*(i-1))) +U8((k+1)+(((N2*2)+1)*(i-1))))/2)));
C14 = (((dt2*sig)/dx2sq)*(((U14((k+1)+(((N2*2)+1)*(i+1))) + U14((k)+(((N2*2)+1)*(i+1))))/2) - (U14((k+1)+(((N2*2)+1)*(i))) + U14((k+1)+(((N2*2)+1)*(i))))+ ((U14((k+1)+(((N2*2)+1)*(i-1)))+U14((k+1)+(((N2*2)+1)*(i-1))))/2)));


FV2(i)  = A2  + B2  - C2;
FV8(i)  = A8  + B8  - C8;
FV14(i) = A14 + B14 - C14;
% fprintf ( 1, '\n' );
% disp(A);
% disp(B);
% disp(C);
% disp(FV(i));
% fprintf ( 1, '\n' );
end
 %V = F/U;
%disp(FV);
 %disp(V);
V2  = (F2)  \ ((F2  * V2)  - FV2) ;
V8  = (F8)  \ ((F8  * V8)  - FV8) ;
V14 = (F14) \ ((F14 * V14) - FV14) ;

%disp(V);
for i=1:N2-1
%disp((k+2)+((N+1)*(i)));
U2((k+2)+(((N2*2)+1)*(i)))  = V2(i);
U8((k+2)+(((N2*2)+1)*(i)))  = V8(i);
U14((k+2)+(((N2*2)+1)*(i))) = V14(i);
end
%disp(U);
%V = mldivide(((mtimes(F,V)) - FV), F) ;
end


for k=1:((N3*2)-1)
for i=1:N3-1 % loop over elements
for j=1:N3-1
if i == j
F3((i*(N3) - (N3-1)))  = 1 + (dt3/(2*dx3))*(((1-p1)/4)*(U3((k+1)+(((N3*2)+1)*(j+1)))  + U3((k)+(((N3*2)+1)*(j+1)))  - U3((k+1)+(((N3*2)+1)*(j-1)))  - U3((k)+(((N3*2)+1)*(j-1)))))  + ((dt3 * sig)/dx3sq) ;

F9((i*(N3) - (N3-1)))  = 1 + (dt3/(2*dx3))*(((1-p2)/4)*(U9((k+1)+(((N3*2)+1)*(j+1)))  + U9((k)+(((N3*2)+1)*(j+1)))  - U9((k+1)+(((N3*2)+1)*(j-1)))  - U9((k)+(((N3*2)+1)*(j-1)))))  + ((dt3 * sig)/dx3sq) ;

F15((i*(N3) - (N3-1))) = 1 + (dt3/(2*dx3))*(((1-p3)/4)*(U15((k+1)+(((N3*2)+1)*(j+1))) + U15((k)+(((N3*2)+1)*(j+1))) - U15((k+1)+(((N3*2)+1)*(j-1))) - U15((k)+(((N3*2)+1)*(j-1))))) + ((dt3 * sig)/dx3sq) ;

%                    1 + (dt/(2*dx))*(((1-p)/4)*(un1j1 + unj1 - un11j - un1j)) + ((dt * sig)/dxsq) ;
%disp(F(1));
elseif i == j + 1
F3(2 + (N3* (i-2)))  = ((dt3/(2*dx3))*((((p1)/8)*((2*U3((k+1)+(((N3*2)+1)*(j))))  + (2*U3((k)+(((N3*2)+1)*(j))))))  + (((1-p1)/4)*( U3((k+1)+(((N3*2)+1)*(j-1)))  + U3((k)+(((N3*2)+1)*(j-1))))) )  - ((dt3 * sig)/(dx3sq * 2))) * 1 ;

F9(2 + (N3* (i-2)))  = ((dt3/(2*dx3))*((((p2)/8)*((2*U9((k+1)+(((N3*2)+1)*(j))))  + (2*U9((k)+(((N3*2)+1)*(j))))))  + (((1-p2)/4)*( U9((k+1)+(((N3*2)+1)*(j-1)))  + U9((k)+(((N3*2)+1)*(j-1))))) )  - ((dt3 * sig)/(dx3sq * 2))) * 1 ;

F15(2 + (N3* (i-2))) = ((dt3/(2*dx3))*((((p3)/8)*((2*U15((k+1)+(((N3*2)+1)*(j)))) + (2*U15((k)+(((N3*2)+1)*(j)))))) + (((1-p3)/4)*( U15((k+1)+(((N3*2)+1)*(j-1))) + U15((k)+(((N3*2)+1)*(j-1))))) ) - ((dt3 * sig)/(dx3sq * 2))) * 1 ;
%                   ((dt/(2*dx))*((((p)/8)*((2*un1j1) + (2*unj1))) + (((1-p)/4)*( un1j + unj)) ) - ((dt * sig)/(dxsq * 2))) * -1 ;
elseif i + 1 == j
F3(N3 + (N3* (i-1)))  = ((dt3/(2*dx3))*((((p1)/8)*((2*U3((k+1)+(((N3*2)+1)*(j))))  + (2*U3((k)+(((N3*2)+1)*(j))))))  + (((1-p1)/4)*( U3((k+1)+(((N3*2)+1)*(j+1)))  + U3((k)+(((N3*2)+1)*(j+1))))) )  + ((dt3 * sig)/(dx3sq * 2))) * -1 ;

F9(N3 + (N3* (i-1)))  = ((dt3/(2*dx3))*((((p2)/8)*((2*U9((k+1)+(((N3*2)+1)*(j))))  + (2*U9((k)+(((N3*2)+1)*(j))))))  + (((1-p2)/4)*( U9((k+1)+(((N3*2)+1)*(j+1)))  + U9((k)+(((N3*2)+1)*(j+1))))) )  + ((dt3 * sig)/(dx3sq * 2))) * -1 ;

F15(N3 + (N3* (i-1))) = ((dt3/(2*dx3))*((((p3)/8)*((2*U15((k+1)+(((N3*2)+1)*(j)))) + (2*U15((k)+(((N3*2)+1)*(j)))))) + (((1-p3)/4)*( U15((k+1)+(((N3*2)+1)*(j+1))) + U15((k)+(((N3*2)+1)*(j+1))))) ) + ((dt3 * sig)/(dx3sq * 2))) * -1 ;

%                   (dt/(2*dx))*((((p)/8)*((2*un1j1) + (2*unj1))) + (((1-p)/4)*( un1j + unj)) ) - ((dt * sig)/(dxsq * 2)) ;
else
%F() = 0;
end
end
%FV(i) = U((i+1)+(N+1))+ U((i)+(N+1))+ (dt/(2*dx))*((((p)/8)*((U((i+1)+((N+1)*(2)))*U((i+1)+((N+1)*(2)))) + (U((i)+((N+1)*(2)))*U((i)+((N+1)*(2))))+ (U((i+1)+((N+1)*(2)))*2*U((i)+((N+1)*(2))))-(U((i+1)+((N+1)*(0)))*U((i+1)+((N+1)*(0)))) - (U((i)+((N+1)*(0)))*U((i)+((N+1)*(0))))+ (U((i+1)+((N+1)*(0)))*2*U((i)+((N+1)*(0))))))+ (((1-p)/4)*( (U((i+1)+((N+1)*(1)))*U((i+1)+((N+1)*(2)))) + (U((i+1)+((N+1)*(1)))*U((i)+((N+1)*(2))))-(U((i+1)+((N+1)*(1)))*U((i+1)+((N+1)*(0)))) - (U((i+1)+((N+1)*(1)))*U((i)+((N+1)*(0))))+(U((i)+((N+1)*(1)))*U((i+1)+((N+1)*(2)))) + (U((i)+((N+1)*(1)))*U((i)+((N+1)*(2))))-(U((i)+((N+1)*(1)))*U((i+1)+((N+1)*(0)))) - (U((i)+((N+1)*(1)))*U((i)+((N+1)*(0)))))))-((dt*sig)/dxsq)*(((U((i+1)+((N+1)*(2))) + U((i)+((N+1)*(2))))/2) - (U((i+1)+((N+1)*(1))) + U((i+1)+((N+1)*(1))))+ ((U((i+1)+((N+1)*(0)))+U((i+1)+((N+1)*(0))))/2));
end
%disp(F);
for i=1:N3-1
 
A3  = U3((k+1)+(((N3*2)+1)*i)) + U3((k)+(((N3*2)+1)*i));
A9  = U9((k+1)+(((N3*2)+1)*i)) + U9((k)+(((N3*2)+1)*i));
A15 = U15((k+1)+(((N3*2)+1)*i))+ U15((k)+(((N3*2)+1)*i));

B3  = (dt3/(2*dx3))*((((p1)/8)*((U3((k+1)+(((N3*2)+1)*(i+1))) *U3((k+1)+(((N3*2)+1)*(i+1))))  + (U3((k)+(((N3*2)+1)*(i+1))) *U3((k)+(((N3*2)+1)*(i+1)))) + (U3((k+1)+(((N3*2)+1)*(i+1)))*2 *U3((k)+(((N3*2)+1)*(i+1)))) -(U3((k+1)+(((N3*2)+1)*(i-1))) *U3((k+1)+(((N3*2)+1)*(i-1))))  - (U3((k)+(((N3*2)+1)*(i-1))) *U3((k)+(((N3*2)+1)*(i-1))))  - (U3((k+1)+(((N3*2)+1)*(i-1)))*2 *U3((k)+(((N3*2)+1)*(i-1))))))  + (((1-p1)/4)*( (U3((k+1)+(((N3*2)+1)*(i))) *U3((k+1)+(((N3*2)+1)*(i+1))))  + (U3((k+1)+(((N3*2)+1)*(i))) *U3((k)+(((N3*2)+1)*(i+1)))) -(U3((k+1)+(((N3*2)+1)*(i))) *U3((k+1)+(((N3*2)+1)*(i-1))))  - (U3((k+1)+(((N3*2)+1)*(i))) *U3((k)+(((N3*2)+1)*(i-1)))) +(U3((k)+(((N3*2)+1)*(i))) *U3((k+1)+(((N3*2)+1)*(i+1))))  + (U3((k)+(((N3*2)+1)*(i))) *U3((k)+(((N3*2)+1)*(i+1)))) -(U3((k)+(((N3*2)+1)*(i))) *U3((k+1)+(((N3*2)+1)*(i-1))))  - (U3((k)+(((N3*2)+1)*(i))) *U3((k)+(((N3*2)+1)*(i-1)))))));
B9  = (dt3/(2*dx3))*((((p2)/8)*((U9((k+1)+(((N3*2)+1)*(i+1))) *U9((k+1)+(((N3*2)+1)*(i+1))))  + (U9((k)+(((N3*2)+1)*(i+1))) *U9((k)+(((N3*2)+1)*(i+1)))) + (U9((k+1)+(((N3*2)+1)*(i+1)))*2 *U9((k)+(((N3*2)+1)*(i+1)))) -(U9((k+1)+(((N3*2)+1)*(i-1))) *U9((k+1)+(((N3*2)+1)*(i-1))))  - (U9((k)+(((N3*2)+1)*(i-1))) *U9((k)+(((N3*2)+1)*(i-1))))  - (U9((k+1)+(((N3*2)+1)*(i-1)))*2 *U9((k)+(((N3*2)+1)*(i-1))))))  + (((1-p2)/4)*( (U9((k+1)+(((N3*2)+1)*(i))) *U9((k+1)+(((N3*2)+1)*(i+1))))  + (U9((k+1)+(((N3*2)+1)*(i))) *U9((k)+(((N3*2)+1)*(i+1)))) -(U9((k+1)+(((N3*2)+1)*(i))) *U9((k+1)+(((N3*2)+1)*(i-1))))  - (U9((k+1)+(((N3*2)+1)*(i))) *U9((k)+(((N3*2)+1)*(i-1)))) +(U9((k)+(((N3*2)+1)*(i))) *U9((k+1)+(((N3*2)+1)*(i+1))))  + (U9((k)+(((N3*2)+1)*(i))) *U9((k)+(((N3*2)+1)*(i+1)))) -(U9((k)+(((N3*2)+1)*(i))) *U9((k+1)+(((N3*2)+1)*(i-1))))  - (U9((k)+(((N3*2)+1)*(i))) *U9((k)+(((N3*2)+1)*(i-1)))))));
B15 = (dt3/(2*dx3))*((((p3)/8)*((U15((k+1)+(((N3*2)+1)*(i+1)))*U15((k+1)+(((N3*2)+1)*(i+1)))) + (U15((k)+(((N3*2)+1)*(i+1)))*U15((k)+(((N3*2)+1)*(i+1))))+ (U15((k+1)+(((N3*2)+1)*(i+1)))*2*U15((k)+(((N3*2)+1)*(i+1))))-(U15((k+1)+(((N3*2)+1)*(i-1)))*U15((k+1)+(((N3*2)+1)*(i-1)))) - (U15((k)+(((N3*2)+1)*(i-1)))*U15((k)+(((N3*2)+1)*(i-1)))) - (U15((k+1)+(((N3*2)+1)*(i-1)))*2*U15((k)+(((N3*2)+1)*(i-1)))))) + (((1-p3)/4)*( (U15((k+1)+(((N3*2)+1)*(i)))*U15((k+1)+(((N3*2)+1)*(i+1)))) + (U15((k+1)+(((N3*2)+1)*(i)))*U15((k)+(((N3*2)+1)*(i+1))))-(U15((k+1)+(((N3*2)+1)*(i)))*U15((k+1)+(((N3*2)+1)*(i-1)))) - (U15((k+1)+(((N3*2)+1)*(i)))*U15((k)+(((N3*2)+1)*(i-1))))+(U15((k)+(((N3*2)+1)*(i)))*U15((k+1)+(((N3*2)+1)*(i+1)))) + (U15((k)+(((N3*2)+1)*(i)))*U15((k)+(((N3*2)+1)*(i+1))))-(U15((k)+(((N3*2)+1)*(i)))*U15((k+1)+(((N3*2)+1)*(i-1)))) - (U15((k)+(((N3*2)+1)*(i)))*U15((k)+(((N3*2)+1)*(i-1)))))));

C3  = (((dt3*sig)/dx3sq)*(((U3((k+1)+(((N3*2)+1)*(i+1)))  + U3((k)+(((N3*2)+1)*(i+1))))/2)  - (U3((k+1)+(((N3*2)+1)*(i)))  + U3((k+1)+(((N3*2)+1)*(i)))) + ((U3((k+1)+(((N3*2)+1)*(i-1))) +U3((k+1)+(((N3*2)+1)*(i-1))))/2)));
C9  = (((dt3*sig)/dx3sq)*(((U9((k+1)+(((N3*2)+1)*(i+1)))  + U9((k)+(((N3*2)+1)*(i+1))))/2)  - (U9((k+1)+(((N3*2)+1)*(i)))  + U9((k+1)+(((N3*2)+1)*(i)))) + ((U9((k+1)+(((N3*2)+1)*(i-1))) +U9((k+1)+(((N3*2)+1)*(i-1))))/2)));
C15 = (((dt3*sig)/dx3sq)*(((U15((k+1)+(((N3*2)+1)*(i+1))) + U15((k)+(((N3*2)+1)*(i+1))))/2) - (U15((k+1)+(((N3*2)+1)*(i))) + U15((k+1)+(((N3*2)+1)*(i))))+ ((U15((k+1)+(((N3*2)+1)*(i-1)))+U15((k+1)+(((N3*2)+1)*(i-1))))/2)));


FV3(i)  = A3  + B3  - C3;
FV9(i)  = A9  + B9  - C9;
FV15(i) = A15 + B15 - C15;
% fprintf ( 1, '\n' );
% disp(A);
% disp(B);
% disp(C);
% disp(FV(i));
% fprintf ( 1, '\n' );
end
 %V = F/U;
%disp(FV);
 %disp(V);
V3  = (F3)  \ ((F3  * V3)  - FV3) ;
V9  = (F9)  \ ((F9  * V9)  - FV9) ;
V15 = (F15) \ ((F15 * V15) - FV15) ;

%disp(V);
for i=1:N3-1
%disp((k+2)+((N+1)*(i)));
U3((k+2)+(((N3*2)+1)*(i)))  = V3(i);
U9((k+2)+(((N3*2)+1)*(i)))  = V9(i);
U15((k+2)+(((N3*2)+1)*(i))) = V15(i);
end
%disp(U);
%V = mldivide(((mtimes(F,V)) - FV), F) ;
end

for k=1:(N1-1)
for i=1:N1-1 % loop over elements
for j=1:N1-1
if i == j
F4((i*(N1) - (N1-1)))  = 1 + (dt1/(2*dx1))*(((1-p1)/4)*(U4((k+1)+(((N1)+1)*(j+1)))  + U4((k)+(((N1)+1)*(j+1)))  - U4((k+1)+(((N1)+1)*(j-1)))  - U4((k)+(((N1)+1)*(j-1)))))  + ((dt1 * sig)/dx1sq) ;

F10((i*(N1) - (N1-1)))  = 1 + (dt1/(2*dx1))*(((1-p2)/4)*(U10((k+1)+(((N1)+1)*(j+1)))  + U10((k)+(((N1)+1)*(j+1)))  - U10((k+1)+(((N1)+1)*(j-1)))  - U10((k)+(((N1)+1)*(j-1)))))  + ((dt1 * sig)/dx1sq) ;

F16((i*(N1) - (N1-1))) = 1 + (dt1/(2*dx1))*(((1-p3)/4)*(U16((k+1)+(((N1)+1)*(j+1))) + U16((k)+(((N1)+1)*(j+1))) - U16((k+1)+(((N1)+1)*(j-1))) - U16((k)+(((N1)+1)*(j-1))))) + ((dt1 * sig)/dx1sq) ;

%                    1 + (dt/(2*dx))*(((1-p)/4)*(un1j1 + unj1 - un11j - un1j)) + ((dt * sig)/dxsq) ;
%disp(F(1));
elseif i == j + 1
F4(2 + (N1* (i-2)))  = ((dt1/(2*dx1))*((((p1)/8)*((2*U4((k+1)+(((N1)+1)*(j))))  + (2*U4((k)+(((N1)+1)*(j))))))  + (((1-p1)/4)*( U4((k+1)+(((N1)+1)*(j-1)))  + U4((k)+(((N1)+1)*(j-1))))) )  - ((dt1 * sig)/(dx1sq * 2))) * 1 ;

F10(2 + (N1* (i-2)))  = ((dt1/(2*dx1))*((((p2)/8)*((2*U10((k+1)+(((N1)+1)*(j))))  + (2*U10((k)+(((N1)+1)*(j))))))  + (((1-p2)/4)*( U10((k+1)+(((N1)+1)*(j-1)))  + U10((k)+(((N1)+1)*(j-1))))) )  - ((dt1 * sig)/(dx1sq * 2))) * 1 ;

F16(2 + (N1* (i-2))) = ((dt1/(2*dx1))*((((p3)/8)*((2*U16((k+1)+(((N1)+1)*(j)))) + (2*U16((k)+(((N1)+1)*(j)))))) + (((1-p3)/4)*( U16((k+1)+(((N1)+1)*(j-1))) + U16((k)+(((N1)+1)*(j-1))))) ) - ((dt1 * sig)/(dx1sq * 2))) * 1 ;
%                   ((dt/(2*dx))*((((p)/8)*((2*un1j1) + (2*unj1))) + (((1-p)/4)*( un1j + unj)) ) - ((dt * sig)/(dxsq * 2))) * -1 ;
elseif i + 1 == j
F4(N1 + (N1* (i-1)))  = ((dt1/(2*dx1))*((((p1)/8)*((2*U4((k+1)+(((N1)+1)*(j))))  + (2*U4((k)+(((N1)+1)*(j))))))  + (((1-p1)/4)*( U4((k+1)+(((N1)+1)*(j+1)))  + U4((k)+(((N1)+1)*(j+1))))) )  + ((dt1 * sig)/(dx1sq * 2))) * -1 ;

F10(N1 + (N1* (i-1)))  = ((dt1/(2*dx1))*((((p2)/8)*((2*U10((k+1)+(((N1)+1)*(j))))  + (2*U10((k)+(((N1)+1)*(j))))))  + (((1-p2)/4)*( U10((k+1)+(((N1)+1)*(j+1)))  + U10((k)+(((N1)+1)*(j+1))))) )  + ((dt1 * sig)/(dx1sq * 2))) * -1 ;

F16(N1 + (N1* (i-1))) = ((dt1/(2*dx1))*((((p3)/8)*((2*U16((k+1)+(((N1)+1)*(j)))) + (2*U16((k)+(((N1)+1)*(j)))))) + (((1-p3)/4)*( U16((k+1)+(((N1)+1)*(j+1))) + U16((k)+(((N1)+1)*(j+1))))) ) + ((dt1 * sig)/(dx1sq * 2))) * -1 ;

%                   (dt/(2*dx))*((((p)/8)*((2*un1j1) + (2*unj1))) + (((1-p)/4)*( un1j + unj)) ) - ((dt * sig)/(dxsq * 2)) ;
else
%F() = 0;
end
end
%FV(i) = U((i+1)+(N+1))+ U((i)+(N+1))+ (dt/(2*dx))*((((p)/8)*((U((i+1)+((N+1)*(2)))*U((i+1)+((N+1)*(2)))) + (U((i)+((N+1)*(2)))*U((i)+((N+1)*(2))))+ (U((i+1)+((N+1)*(2)))*2*U((i)+((N+1)*(2))))-(U((i+1)+((N+1)*(0)))*U((i+1)+((N+1)*(0)))) - (U((i)+((N+1)*(0)))*U((i)+((N+1)*(0))))+ (U((i+1)+((N+1)*(0)))*2*U((i)+((N+1)*(0))))))+ (((1-p)/4)*( (U((i+1)+((N+1)*(1)))*U((i+1)+((N+1)*(2)))) + (U((i+1)+((N+1)*(1)))*U((i)+((N+1)*(2))))-(U((i+1)+((N+1)*(1)))*U((i+1)+((N+1)*(0)))) - (U((i+1)+((N+1)*(1)))*U((i)+((N+1)*(0))))+(U((i)+((N+1)*(1)))*U((i+1)+((N+1)*(2)))) + (U((i)+((N+1)*(1)))*U((i)+((N+1)*(2))))-(U((i)+((N+1)*(1)))*U((i+1)+((N+1)*(0)))) - (U((i)+((N+1)*(1)))*U((i)+((N+1)*(0)))))))-((dt*sig)/dxsq)*(((U((i+1)+((N+1)*(2))) + U((i)+((N+1)*(2))))/2) - (U((i+1)+((N+1)*(1))) + U((i+1)+((N+1)*(1))))+ ((U((i+1)+((N+1)*(0)))+U((i+1)+((N+1)*(0))))/2));
end
%disp(F);
for i=1:N1-1
 
A4  = U4((k+1)+(((N1)+1)*i)) + U4((k)+(((N1)+1)*i));
A10  = U10((k+1)+(((N1)+1)*i)) + U10((k)+(((N1)+1)*i));
A16 = U16((k+1)+(((N1)+1)*i))+ U16((k)+(((N1)+1)*i));

B4  = (dt1/(2*dx1))*((((p1)/8)*((U4((k+1)+(((N1)+1)*(i+1))) *U4((k+1)+(((N1)+1)*(i+1))))  + (U4((k)+(((N1)+1)*(i+1))) *U4((k)+(((N1)+1)*(i+1)))) + (U4((k+1)+(((N1)+1)*(i+1)))*2 *U4((k)+(((N1)+1)*(i+1)))) -(U4((k+1)+(((N1)+1)*(i-1))) *U4((k+1)+(((N1)+1)*(i-1))))  - (U4((k)+(((N1)+1)*(i-1))) *U4((k)+(((N1)+1)*(i-1))))  - (U4((k+1)+(((N1)+1)*(i-1)))*2 *U4((k)+(((N1)+1)*(i-1))))))  + (((1-p1)/4)*( (U4((k+1)+(((N1)+1)*(i))) *U4((k+1)+(((N1)+1)*(i+1))))  + (U4((k+1)+(((N1)+1)*(i))) *U4((k)+(((N1)+1)*(i+1)))) -(U4((k+1)+(((N1)+1)*(i))) *U4((k+1)+(((N1)+1)*(i-1))))  - (U4((k+1)+(((N1)+1)*(i))) *U4((k)+(((N1)+1)*(i-1)))) +(U4((k)+(((N1)+1)*(i))) *U4((k+1)+(((N1)+1)*(i+1))))  + (U4((k)+(((N1)+1)*(i))) *U4((k)+(((N1)+1)*(i+1)))) -(U4((k)+(((N1)+1)*(i))) *U4((k+1)+(((N1)+1)*(i-1))))  - (U4((k)+(((N1)+1)*(i))) *U4((k)+(((N1)+1)*(i-1)))))));
B10  = (dt1/(2*dx1))*((((p2)/8)*((U10((k+1)+(((N1)+1)*(i+1))) *U10((k+1)+(((N1)+1)*(i+1))))  + (U10((k)+(((N1)+1)*(i+1))) *U10((k)+(((N1)+1)*(i+1)))) + (U10((k+1)+(((N1)+1)*(i+1)))*2 *U10((k)+(((N1)+1)*(i+1)))) -(U10((k+1)+(((N1)+1)*(i-1))) *U10((k+1)+(((N1)+1)*(i-1))))  - (U10((k)+(((N1)+1)*(i-1))) *U10((k)+(((N1)+1)*(i-1))))  - (U10((k+1)+(((N1)+1)*(i-1)))*2 *U10((k)+(((N1)+1)*(i-1))))))  + (((1-p2)/4)*( (U10((k+1)+(((N1)+1)*(i))) *U10((k+1)+(((N1)+1)*(i+1))))  + (U10((k+1)+(((N1)+1)*(i))) *U10((k)+(((N1)+1)*(i+1)))) -(U10((k+1)+(((N1)+1)*(i))) *U10((k+1)+(((N1)+1)*(i-1))))  - (U10((k+1)+(((N1)+1)*(i))) *U10((k)+(((N1)+1)*(i-1)))) +(U10((k)+(((N1)+1)*(i))) *U10((k+1)+(((N1)+1)*(i+1))))  + (U10((k)+(((N1)+1)*(i))) *U10((k)+(((N1)+1)*(i+1)))) -(U10((k)+(((N1)+1)*(i))) *U10((k+1)+(((N1)+1)*(i-1))))  - (U10((k)+(((N1)+1)*(i))) *U10((k)+(((N1)+1)*(i-1)))))));
B16 = (dt1/(2*dx1))*((((p3)/8)*((U16((k+1)+(((N1)+1)*(i+1)))*U16((k+1)+(((N1)+1)*(i+1)))) + (U16((k)+(((N1)+1)*(i+1)))*U16((k)+(((N1)+1)*(i+1))))+ (U16((k+1)+(((N1)+1)*(i+1)))*2*U16((k)+(((N1)+1)*(i+1))))-(U16((k+1)+(((N1)+1)*(i-1)))*U16((k+1)+(((N1)+1)*(i-1)))) - (U16((k)+(((N1)+1)*(i-1)))*U16((k)+(((N1)+1)*(i-1)))) - (U16((k+1)+(((N1)+1)*(i-1)))*2*U16((k)+(((N1)+1)*(i-1)))))) + (((1-p3)/4)*( (U16((k+1)+(((N1)+1)*(i)))*U16((k+1)+(((N1)+1)*(i+1)))) + (U16((k+1)+(((N1)+1)*(i)))*U16((k)+(((N1)+1)*(i+1))))-(U16((k+1)+(((N1)+1)*(i)))*U16((k+1)+(((N1)+1)*(i-1)))) - (U16((k+1)+(((N1)+1)*(i)))*U16((k)+(((N1)+1)*(i-1))))+(U16((k)+(((N1)+1)*(i)))*U16((k+1)+(((N1)+1)*(i+1)))) + (U16((k)+(((N1)+1)*(i)))*U16((k)+(((N1)+1)*(i+1))))-(U16((k)+(((N1)+1)*(i)))*U16((k+1)+(((N1)+1)*(i-1)))) - (U16((k)+(((N1)+1)*(i)))*U16((k)+(((N1)+1)*(i-1)))))));

C4  = (((dt1*sig)/dx1sq)*(((U4((k+1)+(((N1)+1)*(i+1)))  + U4((k)+(((N1)+1)*(i+1))))/2)  - (U4((k+1)+(((N1)+1)*(i)))  + U4((k+1)+(((N1)+1)*(i)))) + ((U4((k+1)+(((N1)+1)*(i-1))) +U4((k+1)+(((N1)+1)*(i-1))))/2)));
C10  = (((dt1*sig)/dx1sq)*(((U10((k+1)+(((N1)+1)*(i+1)))  + U10((k)+(((N1)+1)*(i+1))))/2)  - (U10((k+1)+(((N1)+1)*(i)))  + U10((k+1)+(((N1)+1)*(i)))) + ((U10((k+1)+(((N1)+1)*(i-1))) +U10((k+1)+(((N1)+1)*(i-1))))/2)));
C16 = (((dt1*sig)/dx1sq)*(((U16((k+1)+(((N1)+1)*(i+1))) + U16((k)+(((N1)+1)*(i+1))))/2) - (U16((k+1)+(((N1)+1)*(i))) + U16((k+1)+(((N1)+1)*(i))))+ ((U16((k+1)+(((N1)+1)*(i-1)))+U16((k+1)+(((N1)+1)*(i-1))))/2)));


FV4(i)  = A4  + B4  - C4;
FV10(i)  = A10  + B10  - C10;
FV16(i) = A16 + B16 - C16;
% fprintf ( 1, '\n' );
% disp(A);
% disp(B);
% disp(C);
% disp(FV(i));
% fprintf ( 1, '\n' );
end
 %V = F/U;
%disp(FV);
 %disp(V);
V4  = (F4)  \ ((F4  * V4)  - FV4) ;
V10  = (F10)  \ ((F10  * V10)  - FV10) ;
V16 = (F16) \ ((F16 * V16) - FV16) ;

%disp(V);
for i=1:N1-1
%disp((k+2)+((N+1)*(i)));
U4((k+2)+(((N1)+1)*(i)))  = V4(i);
U10((k+2)+(((N1)+1)*(i)))  = V10(i);
U16((k+2)+(((N1)+1)*(i))) = V16(i);
end
%disp(U);
%V = mldivide(((mtimes(F,V)) - FV), F) ;
end

for k=1:(N2-1)
for i=1:N2-1 % loop over elements
for j=1:N2-1
if i == j
F5((i*(N2) - (N2-1)))  = 1 + (dt2/(2*dx2))*(((1-p1)/4)*(U5((k+1)+(((N2)+1)*(j+1)))  + U2((k)+(((N2)+1)*(j+1)))  - U2((k+1)+(((N2)+1)*(j-1)))  - U2((k)+(((N2)+1)*(j-1)))))  + ((dt2 * sig)/dx2sq) ;
F11((i*(N2) - (N2-1)))  = 1 + (dt2/(2*dx2))*(((1-p2)/4)*(U11((k+1)+(((N2)+1)*(j+1)))  + U11((k)+(((N2)+1)*(j+1)))  - U11((k+1)+(((N2)+1)*(j-1)))  - U11((k)+(((N2)+1)*(j-1)))))  + ((dt2 * sig)/dx2sq) ;
F17((i*(N2) - (N2-1))) = 1 + (dt2/(2*dx2))*(((1-p3)/4)*(U17((k+1)+(((N2)+1)*(j+1))) + U14((k)+(((N2)+1)*(j+1))) - U14((k+1)+(((N2)+1)*(j-1))) - U14((k)+(((N2)+1)*(j-1))))) + ((dt2 * sig)/dx2sq) ;

%                    1 + (dt/(2*dx))*(((1-p)/4)*(un1j1 + unj1 - un11j - un1j)) + ((dt * sig)/dxsq) ;
%disp(F(1));
elseif i == j + 1
F5(2 + (N2* (i-2)))  = ((dt2/(2*dx2))*((((p1)/8)*((2*U5((k+1)+(((N2)+1)*(j))))  + (2*U5((k)+(((N2)+1)*(j))))))  + (((1-p1)/4)*( U5((k+1)+(((N2)+1)*(j-1)))  + U5((k)+(((N2)+1)*(j-1))))) )  - ((dt2 * sig)/(dx2sq * 2))) * 1 ;
F11(2 + (N2* (i-2)))  = ((dt2/(2*dx2))*((((p2)/8)*((2*U11((k+1)+(((N2)+1)*(j))))  + (2*U11((k)+(((N2)+1)*(j))))))  + (((1-p2)/4)*( U11((k+1)+(((N2)+1)*(j-1)))  + U11((k)+(((N2)+1)*(j-1))))) )  - ((dt2 * sig)/(dx2sq * 2))) * 1 ;
F17(2 + (N2* (i-2))) = ((dt2/(2*dx2))*((((p3)/8)*((2*U17((k+1)+(((N2)+1)*(j)))) + (2*U17((k)+(((N2)+1)*(j)))))) + (((1-p3)/4)*( U17((k+1)+(((N2)+1)*(j-1))) + U17((k)+(((N2)+1)*(j-1))))) ) - ((dt2 * sig)/(dx2sq * 2))) * 1 ;
%                   ((dt/(2*dx))*((((p)/8)*((2*un1j1) + (2*unj1))) + (((1-p)/4)*( un1j + unj)) ) - ((dt * sig)/(dxsq * 2))) * -1 ;
elseif i + 1 == j
F5(N2 + (N2* (i-1)))  = ((dt2/(2*dx2))*((((p1)/8)*((2*U5((k+1)+(((N2)+1)*(j))))  + (2*U5((k)+(((N2)+1)*(j))))))  + (((1-p1)/4)*( U5((k+1)+(((N2)+1)*(j+1)))  + U5((k)+(((N2)+1)*(j+1))))) )  + ((dt2 * sig)/(dx2sq * 2))) * -1 ;
F11(N2 + (N2* (i-1)))  = ((dt2/(2*dx2))*((((p2)/8)*((2*U11((k+1)+(((N2)+1)*(j))))  + (2*U11((k)+(((N2)+1)*(j))))))  + (((1-p2)/4)*( U11((k+1)+(((N2)+1)*(j+1)))  + U11((k)+(((N2)+1)*(j+1))))) )  + ((dt2 * sig)/(dx2sq * 2))) * -1 ;
F17(N2 + (N2* (i-1))) = ((dt2/(2*dx2))*((((p3)/8)*((2*U17((k+1)+(((N2)+1)*(j)))) + (2*U17((k)+(((N2)+1)*(j)))))) + (((1-p3)/4)*( U17((k+1)+(((N2)+1)*(j+1))) + U17((k)+(((N2)+1)*(j+1))))) ) + ((dt2 * sig)/(dx2sq * 2))) * -1 ;

%                   (dt/(2*dx))*((((p)/8)*((2*un1j1) + (2*unj1))) + (((1-p)/4)*( un1j + unj)) ) - ((dt * sig)/(dxsq * 2)) ;
else
%F() = 0;
end
end
%FV(i) = U((i+1)+(N+1))+ U((i)+(N+1))+ (dt/(2*dx))*((((p)/8)*((U((i+1)+((N+1)*(2)))*U((i+1)+((N+1)*(2)))) + (U((i)+((N+1)*(2)))*U((i)+((N+1)*(2))))+ (U((i+1)+((N+1)*(2)))*2*U((i)+((N+1)*(2))))-(U((i+1)+((N+1)*(0)))*U((i+1)+((N+1)*(0)))) - (U((i)+((N+1)*(0)))*U((i)+((N+1)*(0))))+ (U((i+1)+((N+1)*(0)))*2*U((i)+((N+1)*(0))))))+ (((1-p)/4)*( (U((i+1)+((N+1)*(1)))*U((i+1)+((N+1)*(2)))) + (U((i+1)+((N+1)*(1)))*U((i)+((N+1)*(2))))-(U((i+1)+((N+1)*(1)))*U((i+1)+((N+1)*(0)))) - (U((i+1)+((N+1)*(1)))*U((i)+((N+1)*(0))))+(U((i)+((N+1)*(1)))*U((i+1)+((N+1)*(2)))) + (U((i)+((N+1)*(1)))*U((i)+((N+1)*(2))))-(U((i)+((N+1)*(1)))*U((i+1)+((N+1)*(0)))) - (U((i)+((N+1)*(1)))*U((i)+((N+1)*(0)))))))-((dt*sig)/dxsq)*(((U((i+1)+((N+1)*(2))) + U((i)+((N+1)*(2))))/2) - (U((i+1)+((N+1)*(1))) + U((i+1)+((N+1)*(1))))+ ((U((i+1)+((N+1)*(0)))+U((i+1)+((N+1)*(0))))/2));
end
%disp(F);
for i=1:N2-1
 
A5  = U5((k+1)+(((N2)+1)*i)) + U5((k)+(((N2)+1)*i));
A11  = U11((k+1)+(((N2)+1)*i)) + U11((k)+(((N2)+1)*i));
A17 = U17((k+1)+(((N2)+1)*i))+ U17((k)+(((N2)+1)*i));

B5  = (dt2/(2*dx2))*((((p1)/8)*((U5((k+1)+(((N2)+1)*(i+1))) *U5((k+1)+(((N2)+1)*(i+1))))  + (U5((k)+(((N2)+1)*(i+1))) *U5((k)+(((N2)+1)*(i+1)))) + (U5((k+1)+(((N2)+1)*(i+1)))*2 *U5((k)+(((N2)+1)*(i+1)))) -(U5((k+1)+(((N2)+1)*(i-1))) *U5((k+1)+(((N2)+1)*(i-1))))  - (U5((k)+(((N2)+1)*(i-1))) *U5((k)+(((N2)+1)*(i-1))))  - (U5((k+1)+(((N2)+1)*(i-1)))*2 *U5((k)+(((N2)+1)*(i-1))))))  + (((1-p1)/4)*( (U5((k+1)+(((N2)+1)*(i))) *U5((k+1)+(((N2)+1)*(i+1))))  + (U5((k+1)+(((N2)+1)*(i))) *U5((k)+(((N2)+1)*(i+1)))) -(U5((k+1)+(((N2)+1)*(i))) *U5((k+1)+(((N2)+1)*(i-1))))  - (U5((k+1)+(((N2)+1)*(i))) *U5((k)+(((N2)+1)*(i-1)))) +(U5((k)+(((N2)+1)*(i))) *U5((k+1)+(((N2)+1)*(i+1))))  + (U5((k)+(((N2)+1)*(i))) *U5((k)+(((N2)+1)*(i+1)))) -(U5((k)+(((N2)+1)*(i))) *U5((k+1)+(((N2)+1)*(i-1))))  - (U5((k)+(((N2)+1)*(i))) *U5((k)+(((N2)+1)*(i-1)))))));
B11  = (dt2/(2*dx2))*((((p2)/8)*((U11((k+1)+(((N2)+1)*(i+1))) *U11((k+1)+(((N2)+1)*(i+1))))  + (U11((k)+(((N2)+1)*(i+1))) *U11((k)+(((N2)+1)*(i+1)))) + (U11((k+1)+(((N2)+1)*(i+1)))*2 *U11((k)+(((N2)+1)*(i+1)))) -(U11((k+1)+(((N2)+1)*(i-1))) *U11((k+1)+(((N2)+1)*(i-1))))  - (U11((k)+(((N2)+1)*(i-1))) *U11((k)+(((N2)+1)*(i-1))))  - (U11((k+1)+(((N2)+1)*(i-1)))*2 *U11((k)+(((N2)+1)*(i-1))))))  + (((1-p2)/4)*( (U11((k+1)+(((N2)+1)*(i))) *U11((k+1)+(((N2)+1)*(i+1))))  + (U11((k+1)+(((N2)+1)*(i))) *U11((k)+(((N2)+1)*(i+1)))) -(U11((k+1)+(((N2)+1)*(i))) *U11((k+1)+(((N2)+1)*(i-1))))  - (U11((k+1)+(((N2)+1)*(i))) *U11((k)+(((N2)+1)*(i-1)))) +(U11((k)+(((N2)+1)*(i))) *U11((k+1)+(((N2)+1)*(i+1))))  + (U11((k)+(((N2)+1)*(i))) *U11((k)+(((N2)+1)*(i+1)))) -(U11((k)+(((N2)+1)*(i))) *U11((k+1)+(((N2)+1)*(i-1))))  - (U11((k)+(((N2)+1)*(i))) *U11((k)+(((N2)+1)*(i-1)))))));
B17 = (dt2/(2*dx2))*((((p3)/8)*((U17((k+1)+(((N2)+1)*(i+1)))*U17((k+1)+(((N2)+1)*(i+1)))) + (U17((k)+(((N2)+1)*(i+1)))*U17((k)+(((N2)+1)*(i+1))))+ (U17((k+1)+(((N2)+1)*(i+1)))*2*U17((k)+(((N2)+1)*(i+1))))-(U17((k+1)+(((N2)+1)*(i-1)))*U17((k+1)+(((N2)+1)*(i-1)))) - (U17((k)+(((N2)+1)*(i-1)))*U17((k)+(((N2)+1)*(i-1)))) - (U17((k+1)+(((N2)+1)*(i-1)))*2*U17((k)+(((N2)+1)*(i-1)))))) + (((1-p3)/4)*( (U17((k+1)+(((N2)+1)*(i)))*U17((k+1)+(((N2)+1)*(i+1)))) + (U17((k+1)+(((N2)+1)*(i)))*U17((k)+(((N2)+1)*(i+1))))-(U17((k+1)+(((N2)+1)*(i)))*U17((k+1)+(((N2)+1)*(i-1)))) - (U17((k+1)+(((N2)+1)*(i)))*U17((k)+(((N2)+1)*(i-1))))+(U17((k)+(((N2)+1)*(i)))*U17((k+1)+(((N2)+1)*(i+1)))) + (U17((k)+(((N2)+1)*(i)))*U17((k)+(((N2)+1)*(i+1))))-(U17((k)+(((N2)+1)*(i)))*U17((k+1)+(((N2)+1)*(i-1)))) - (U17((k)+(((N2)+1)*(i)))*U17((k)+(((N2)+1)*(i-1)))))));

C5  = (((dt2*sig)/dx2sq)*(((U5((k+1)+(((N2)+1)*(i+1)))  + U5((k)+(((N2)+1)*(i+1))))/2)  - (U5((k+1)+(((N2)+1)*(i)))  + U5((k+1)+(((N2)+1)*(i)))) + ((U5((k+1)+(((N2)+1)*(i-1))) +U5((k+1)+(((N2)+1)*(i-1))))/2)));
C11  = (((dt2*sig)/dx2sq)*(((U11((k+1)+(((N2)+1)*(i+1)))  + U11((k)+(((N2)+1)*(i+1))))/2)  - (U11((k+1)+(((N2)+1)*(i)))  + U11((k+1)+(((N2)+1)*(i)))) + ((U11((k+1)+(((N2)+1)*(i-1))) +U11((k+1)+(((N2)+1)*(i-1))))/2)));
C17 = (((dt2*sig)/dx2sq)*(((U17((k+1)+(((N2)+1)*(i+1))) + U17((k)+(((N2)+1)*(i+1))))/2) - (U17((k+1)+(((N2)+1)*(i))) + U17((k+1)+(((N2)+1)*(i))))+ ((U17((k+1)+(((N2)+1)*(i-1)))+U17((k+1)+(((N2)+1)*(i-1))))/2)));


FV5(i)  = A5  + B5  - C5;
FV11(i)  = A11  + B11  - C11;
FV17(i) = A17 + B17 - C17;
% fprintf ( 1, '\n' );
% disp(A);
% disp(B);
% disp(C);
% disp(FV(i));
% fprintf ( 1, '\n' );
end
 %V = F/U;
%disp(FV);
 %disp(V);
V5  = (F5)  \ ((F5  * V5)  - FV5) ;
V11  = (F11)  \ ((F11  * V11)  - FV11) ;
V17 = (F17) \ ((F17 * V17) - FV17) ;

%disp(V);
for i=1:N2-1
%disp((k+2)+((N+1)*(i)));
U5((k+2)+(((N2)+1)*(i)))  = V5(i);
U11((k+2)+(((N2)+1)*(i)))  = V11(i);
U17((k+2)+(((N2)+1)*(i))) = V17(i);
end
%disp(U);
%V = mldivide(((mtimes(F,V)) - FV), F) ;
end


for k=1:(N3-1)
for i=1:N3-1 % loop over elements
for j=1:N3-1
if i == j
F6((i*(N3) - (N3-1)))  = 1 + (dt3/(2*dx3))*(((1-p1)/4)*(U6((k+1)+(((N3)+1)*(j+1)))  + U6((k)+(((N3)+1)*(j+1)))  - U6((k+1)+(((N3)+1)*(j-1)))  - U6((k)+(((N3)+1)*(j-1)))))  + ((dt3 * sig)/dx3sq) ;

F12((i*(N3) - (N3-1)))  = 1 + (dt3/(2*dx3))*(((1-p2)/4)*(U12((k+1)+(((N3)+1)*(j+1)))  + U12((k)+(((N3)+1)*(j+1)))  - U12((k+1)+(((N3)+1)*(j-1)))  - U12((k)+(((N3)+1)*(j-1)))))  + ((dt3 * sig)/dx3sq) ;

F18((i*(N3) - (N3-1))) = 1 + (dt3/(2*dx3))*(((1-p3)/4)*(U18((k+1)+(((N3)+1)*(j+1))) + U18((k)+(((N3)+1)*(j+1))) - U18((k+1)+(((N3)+1)*(j-1))) - U18((k)+(((N3)+1)*(j-1))))) + ((dt3 * sig)/dx3sq) ;

%                    1 + (dt/(2*dx))*(((1-p)/4)*(un1j1 + unj1 - un11j - un1j)) + ((dt * sig)/dxsq) ;
%disp(F(1));
elseif i == j + 1
F6(2 + (N3* (i-2)))  = ((dt3/(2*dx3))*((((p1)/8)*((2*U6((k+1)+(((N3)+1)*(j))))  + (2*U6((k)+(((N3)+1)*(j))))))  + (((1-p1)/4)*( U6((k+1)+(((N3)+1)*(j-1)))  + U6((k)+(((N3)+1)*(j-1))))) )  - ((dt3 * sig)/(dx3sq * 2))) * 1 ;

F12(2 + (N3* (i-2)))  = ((dt3/(2*dx3))*((((p2)/8)*((2*U12((k+1)+(((N3)+1)*(j))))  + (2*U12((k)+(((N3)+1)*(j))))))  + (((1-p2)/4)*( U12((k+1)+(((N3)+1)*(j-1)))  + U12((k)+(((N3)+1)*(j-1))))) )  - ((dt3 * sig)/(dx3sq * 2))) * 1 ;

F18(2 + (N3* (i-2))) = ((dt3/(2*dx3))*((((p3)/8)*((2*U18((k+1)+(((N3)+1)*(j)))) + (2*U18((k)+(((N3)+1)*(j)))))) + (((1-p3)/4)*( U18((k+1)+(((N3)+1)*(j-1))) + U18((k)+(((N3)+1)*(j-1))))) ) - ((dt3 * sig)/(dx3sq * 2))) * 1 ;
%                   ((dt/(2*dx))*((((p)/8)*((2*un1j1) + (2*unj1))) + (((1-p)/4)*( un1j + unj)) ) - ((dt * sig)/(dxsq * 2))) * -1 ;
elseif i + 1 == j
F3(N3 + (N3* (i-1)))  = ((dt3/(2*dx3))*((((p1)/8)*((2*U6((k+1)+(((N3)+1)*(j))))  + (2*U6((k)+(((N3)+1)*(j))))))  + (((1-p1)/4)*( U6((k+1)+(((N3)+1)*(j+1)))  + U6((k)+(((N3)+1)*(j+1))))) )  + ((dt3 * sig)/(dx3sq * 2))) * -1 ;

F9(N3 + (N3* (i-1)))  = ((dt3/(2*dx3))*((((p2)/8)*((2*U12((k+1)+(((N3)+1)*(j))))  + (2*U12((k)+(((N3)+1)*(j))))))  + (((1-p2)/4)*( U12((k+1)+(((N3)+1)*(j+1)))  + U12((k)+(((N3)+1)*(j+1))))) )  + ((dt3 * sig)/(dx3sq * 2))) * -1 ;

F15(N3 + (N3* (i-1))) = ((dt3/(2*dx3))*((((p3)/8)*((2*U18((k+1)+(((N3)+1)*(j)))) + (2*U18((k)+(((N3)+1)*(j)))))) + (((1-p3)/4)*( U18((k+1)+(((N3)+1)*(j+1))) + U18((k)+(((N3)+1)*(j+1))))) ) + ((dt3 * sig)/(dx3sq * 2))) * -1 ;

%                   (dt/(2*dx))*((((p)/8)*((2*un1j1) + (2*unj1))) + (((1-p)/4)*( un1j + unj)) ) - ((dt * sig)/(dxsq * 2)) ;
else
%F() = 0;
end
end
%FV(i) = U((i+1)+(N+1))+ U((i)+(N+1))+ (dt/(2*dx))*((((p)/8)*((U((i+1)+((N+1)*(2)))*U((i+1)+((N+1)*(2)))) + (U((i)+((N+1)*(2)))*U((i)+((N+1)*(2))))+ (U((i+1)+((N+1)*(2)))*2*U((i)+((N+1)*(2))))-(U((i+1)+((N+1)*(0)))*U((i+1)+((N+1)*(0)))) - (U((i)+((N+1)*(0)))*U((i)+((N+1)*(0))))+ (U((i+1)+((N+1)*(0)))*2*U((i)+((N+1)*(0))))))+ (((1-p)/4)*( (U((i+1)+((N+1)*(1)))*U((i+1)+((N+1)*(2)))) + (U((i+1)+((N+1)*(1)))*U((i)+((N+1)*(2))))-(U((i+1)+((N+1)*(1)))*U((i+1)+((N+1)*(0)))) - (U((i+1)+((N+1)*(1)))*U((i)+((N+1)*(0))))+(U((i)+((N+1)*(1)))*U((i+1)+((N+1)*(2)))) + (U((i)+((N+1)*(1)))*U((i)+((N+1)*(2))))-(U((i)+((N+1)*(1)))*U((i+1)+((N+1)*(0)))) - (U((i)+((N+1)*(1)))*U((i)+((N+1)*(0)))))))-((dt*sig)/dxsq)*(((U((i+1)+((N+1)*(2))) + U((i)+((N+1)*(2))))/2) - (U((i+1)+((N+1)*(1))) + U((i+1)+((N+1)*(1))))+ ((U((i+1)+((N+1)*(0)))+U((i+1)+((N+1)*(0))))/2));
end
%disp(F);
for i=1:N3-1
 
A6  = U6((k+1)+(((N3)+1)*i)) + U6((k)+(((N3)+1)*i));
A12  = U12((k+1)+(((N3)+1)*i)) + U12((k)+(((N3)+1)*i));
A18 = U18((k+1)+(((N3)+1)*i))+ U18((k)+(((N3)+1)*i));

B6  = (dt3/(2*dx3))*((((p1)/8)*((U6((k+1)+(((N3)+1)*(i+1))) *U6((k+1)+(((N3)+1)*(i+1))))  + (U6((k)+(((N3)+1)*(i+1))) *U6((k)+(((N3)+1)*(i+1)))) + (U6((k+1)+(((N3)+1)*(i+1)))*2 *U6((k)+(((N3)+1)*(i+1)))) -(U6((k+1)+(((N3)+1)*(i-1))) *U6((k+1)+(((N3)+1)*(i-1))))  - (U6((k)+(((N3)+1)*(i-1))) *U6((k)+(((N3)+1)*(i-1))))  - (U6((k+1)+(((N3)+1)*(i-1)))*2 *U6((k)+(((N3)+1)*(i-1))))))  + (((1-p1)/4)*( (U6((k+1)+(((N3)+1)*(i))) *U6((k+1)+(((N3)+1)*(i+1))))  + (U6((k+1)+(((N3)+1)*(i))) *U6((k)+(((N3)+1)*(i+1)))) -(U6((k+1)+(((N3)+1)*(i))) *U6((k+1)+(((N3)+1)*(i-1))))  - (U6((k+1)+(((N3)+1)*(i))) *U6((k)+(((N3)+1)*(i-1)))) +(U6((k)+(((N3)+1)*(i))) *U6((k+1)+(((N3)+1)*(i+1))))  + (U6((k)+(((N3)+1)*(i))) *U6((k)+(((N3)+1)*(i+1)))) -(U6((k)+(((N3)+1)*(i))) *U6((k+1)+(((N3)+1)*(i-1))))  - (U6((k)+(((N3)+1)*(i))) *U6((k)+(((N3)+1)*(i-1)))))));
B12  = (dt3/(2*dx3))*((((p2)/8)*((U12((k+1)+(((N3)+1)*(i+1))) *U12((k+1)+(((N3)+1)*(i+1))))  + (U12((k)+(((N3)+1)*(i+1))) *U12((k)+(((N3)+1)*(i+1)))) + (U12((k+1)+(((N3)+1)*(i+1)))*2 *U12((k)+(((N3)+1)*(i+1)))) -(U12((k+1)+(((N3)+1)*(i-1))) *U12((k+1)+(((N3)+1)*(i-1))))  - (U12((k)+(((N3)+1)*(i-1))) *U12((k)+(((N3)+1)*(i-1))))  - (U12((k+1)+(((N3)+1)*(i-1)))*2 *U12((k)+(((N3)+1)*(i-1))))))  + (((1-p2)/4)*( (U12((k+1)+(((N3)+1)*(i))) *U12((k+1)+(((N3)+1)*(i+1))))  + (U12((k+1)+(((N3)+1)*(i))) *U12((k)+(((N3)+1)*(i+1)))) -(U12((k+1)+(((N3)+1)*(i))) *U12((k+1)+(((N3)+1)*(i-1))))  - (U12((k+1)+(((N3)+1)*(i))) *U12((k)+(((N3)+1)*(i-1)))) +(U12((k)+(((N3)+1)*(i))) *U12((k+1)+(((N3)+1)*(i+1))))  + (U12((k)+(((N3)+1)*(i))) *U12((k)+(((N3)+1)*(i+1)))) -(U12((k)+(((N3)+1)*(i))) *U12((k+1)+(((N3)+1)*(i-1))))  - (U12((k)+(((N3)+1)*(i))) *U12((k)+(((N3)+1)*(i-1)))))));
B18 = (dt3/(2*dx3))*((((p3)/8)*((U18((k+1)+(((N3)+1)*(i+1)))*U18((k+1)+(((N3)+1)*(i+1)))) + (U18((k)+(((N3)+1)*(i+1)))*U18((k)+(((N3)+1)*(i+1))))+ (U18((k+1)+(((N3)+1)*(i+1)))*2*U18((k)+(((N3)+1)*(i+1))))-(U18((k+1)+(((N3)+1)*(i-1)))*U18((k+1)+(((N3)+1)*(i-1)))) - (U18((k)+(((N3)+1)*(i-1)))*U18((k)+(((N3)+1)*(i-1)))) - (U18((k+1)+(((N3)+1)*(i-1)))*2*U18((k)+(((N3)+1)*(i-1)))))) + (((1-p3)/4)*( (U18((k+1)+(((N3)+1)*(i)))*U18((k+1)+(((N3)+1)*(i+1)))) + (U18((k+1)+(((N3)+1)*(i)))*U18((k)+(((N3)+1)*(i+1))))-(U18((k+1)+(((N3)+1)*(i)))*U18((k+1)+(((N3)+1)*(i-1)))) - (U18((k+1)+(((N3)+1)*(i)))*U18((k)+(((N3)+1)*(i-1))))+(U18((k)+(((N3)+1)*(i)))*U18((k+1)+(((N3)+1)*(i+1)))) + (U18((k)+(((N3)+1)*(i)))*U18((k)+(((N3)+1)*(i+1))))-(U18((k)+(((N3)+1)*(i)))*U18((k+1)+(((N3)+1)*(i-1)))) - (U18((k)+(((N3)+1)*(i)))*U18((k)+(((N3)+1)*(i-1)))))));

C6  = (((dt3*sig)/dx3sq)*(((U6((k+1)+(((N3)+1)*(i+1)))  + U6((k)+(((N3)+1)*(i+1))))/2)  - (U6((k+1)+(((N3)+1)*(i)))  + U6((k+1)+(((N3)+1)*(i)))) + ((U6((k+1)+(((N3)+1)*(i-1))) +U6((k+1)+(((N3)+1)*(i-1))))/2)));
C12  = (((dt3*sig)/dx3sq)*(((U12((k+1)+(((N3)+1)*(i+1)))  + U12((k)+(((N3)+1)*(i+1))))/2)  - (U12((k+1)+(((N3)+1)*(i)))  + U12((k+1)+(((N3)+1)*(i)))) + ((U12((k+1)+(((N3)+1)*(i-1))) +U12((k+1)+(((N3)+1)*(i-1))))/2)));
C18 = (((dt3*sig)/dx3sq)*(((U18((k+1)+(((N3)+1)*(i+1))) + U18((k)+(((N3)+1)*(i+1))))/2) - (U18((k+1)+(((N3)+1)*(i))) + U18((k+1)+(((N3)+1)*(i))))+ ((U18((k+1)+(((N3)+1)*(i-1)))+U18((k+1)+(((N3)+1)*(i-1))))/2)));


FV6(i)  = A6  + B6  - C6;
FV12(i)  = A12  + B12  - C12;
FV18(i) = A18 + B18 - C18;
% fprintf ( 1, '\n' );
% disp(A);
% disp(B);
% disp(C);
% disp(FV(i));
% fprintf ( 1, '\n' );
end
 %V = F/U;
%disp(FV);
 %disp(V);
V6  = (F6)  \ ((F6  * V6)  - FV6) ;
V12  = (F12)  \ ((F12  * V12)  - FV12) ;
V18 = (F18) \ ((F18 * V18) - FV18) ;

%disp(V);
for i=1:N3-1
%disp((k+2)+((N+1)*(i)));
U6((k+2)+(((N3)+1)*(i)))  = V6(i);
U12((k+2)+(((N3)+1)*(i)))  = V12(i);
U18((k+2)+(((N3)+1)*(i))) = V18(i);
end
%disp(U18);
%V = mldivide(((mtimes(F,V)) - FV), F) ;
end
%disp(U);
%disp(F);
%disp(V);
%disp(FV);

 % ---------------------------- Ploting Graphs here  --------------------------------
% for i=1:N1+1
% G1(i) = U1((1) + (((N1*2)+1)*(i-1)));
% G4(i) = U4((1) + (((N1)+1)*(i-1)));
% G7(i) = U7((1) + (((N1*2)+1)*(i-1)));
% G10(i) = U10((1) + (((N1)+1)*(i-1)));
% G13(i) = U13((1) + (((N1*2)+1)*(i-1)));
% G16(i) = U16((1) + (((N1)+1)*(i-1)));
% end
% for i=1:N2+1
% G2(i) = U2((1) + (((N2*2)+1)*(i-1)));
% G5(i) = U5((1) + (((N2)+1)*(i-1)));
% G8(i) = U8((1) + (((N2*2)+1)*(i-1)));
% G11(i) = U11((1) + (((N2)+1)*(i-1)));
% G14(i) = U14((1) + (((N2*2)+1)*(i-1)));
% G17(i) = U17((1) + (((N2)+1)*(i-1)));
% end
% for i=1:N3+1
% G3(i) = U3((1) + (((N3*2)+1)*(i-1)));
% G6(i) = U6((1) + (((N3)+1)*(i-1)));
% G9(i) = U9((1) + (((N3*2)+1)*(i-1)));
% G12(i) = U12((1) + (((N3)+1)*(i-1)));
% G15(i) = U15((1) + (((N3*2)+1)*(i-1)));
% G18(i) = U18((1) + (((N3)+1)*(i-1)));
% end
% %disp(G);

%-------------------The main graphs------------------------%
% plot(x1,G1,'rx-')
% hold on
% plot(x2,G2,'rx-')
% hold on
% plot(x3,G3,'rx-')
% hold on
% plot(x4,G4,'rx-')
% hold on
% plot(x5,G5,'rx-')
% hold on
% plot(x6,G6,'rx-')
% hold on
% plot(x1,G7,'rx-')
% hold on
% plot(x2,G8,'rx-')
% hold on
% plot(x3,G9,'rx-')
% hold on
% plot(x4,G10,'rx-')
% hold on
% plot(x5,G11,'rx-')
% hold on
% plot(x6,G12,'rx-')
% hold on
% plot(x1,G13,'rx-')
% hold on
% plot(x2,G14,'rx-')
% hold on
% plot(x3,G15,'rx-')
% hold on
% plot(x4,G16,'rx-')
% hold on
% plot(x5,G17,'rx-')
% hold on
% plot(x6,G18,'rx-')
% hold on
% plot(x1,Z1,'gx-')
%-----------------------For t = 0----------------------- %

for i=1:N1+1
G1(i) = U1((1) + (((N1*2)+1)*(i-1)));
end
Z1 = zeros(N1+1,1);
for i=1:N1+1
Z1(i) = 1 - tanh ((x1(i)-(0))/(2*sig));
end
plot(x1,G1,'rx-')
hold on
plot(x1,Z1,'gx-')

%-----------------------For t = 0 end ----------------------- %
%-----------------------For t = 1----------------------- %
% for j=1:N1-1
% U1((N1*2 + 1) + (N1*2 + 1)*j) = U1((N1*2 + 1) + (N1*2 + 1)*j)+S1(j);
% end
% for i=1:N1+1
% G1(i) = U1(((N1*2)+1) + (((N1*2)+1)*(i-1)));
% end
% Z1 = zeros(N1+1,1);
% for i=1:N1+1
% Z1(i) = 1 - tanh ((x1(i)-(1))/(2*sig));
% end
% plot(x1,G1,'rx-')
% hold on
% plot(x1,Z1,'gx-')

%-----------------------For t = 1 end ----------------------- %
%-----------------------For t = 0.5----------------------- %
% for j=1:N1/2-1
% U1((N1 + 1) + (N1*2 + 1)*j) = U1((N1 + 1) + (N1*2 + 1)*j)+S1(j);
% end
% for i=1:N1+1
% G1(i) = U1(((N1)+1) + (((N1*2)+1)*(i-1)));
% end
% Z1 = zeros(N1+1,1);
% for i=1:N1+1
% Z1(i) = 1 - tanh ((x1(i)-(0.5))/(2*sig));
% end
% plot(x1,G1,'rx-')
% hold on
% plot(x1,Z1,'gx-')

%-----------------------For t = 0.5 end ----------------------- %
% for i=1:N1+1
% G1(i) = U1(((N1*2)+1) + (((N1*2)+1)*(i-1)));
% G4(i) = U4(((N1)+1) + (((N1)+1)*(i-1)));
% G7(i) = U7(((N1*2)+1) + (((N1*2)+1)*(i-1)));
% G10(i) = U10((((N1)+1)) + (((N1)+1)*(i-1)));
% G13(i) = U13(((N1*2)+1) + (((N1*2)+1)*(i-1)));
% G16(i) = U16((((N1)+1)) + (((N1)+1)*(i-1)));
% end
% for i=1:N2+1
% G2(i) = U2(((N2*2)+1) + (((N2*2)+1)*(i-1)));
% G5(i) = U5((((N2)+1)) + (((N2)+1)*(i-1)));
% G8(i) = U8(((N2*2)+1) + (((N2*2)+1)*(i-1)));
% G11(i) = U11((((N2)+1)) + (((N2)+1)*(i-1)));
% G14(i) = U14(((N2*2)+1) + (((N2*2)+1)*(i-1)));
% G17(i) = U17((((N2)+1)) + (((N2)+1)*(i-1)));
% end
% for i=1:N3+1
% G3(i) = U3(((N3*2)+1) + (((N3*2)+1)*(i-1)));
% G6(i) = U6((((N3)+1)) + (((N3)+1)*(i-1)));
% G9(i) = U9(((N3*2)+1) + (((N3*2)+1)*(i-1)));
% G12(i) = U12((((N3)+1)) + (((N3)+1)*(i-1)));
% G15(i) = U15(((N3*2)+1) + (((N3*2)+1)*(i-1)));
% G18(i) = U18((((N3)+1)) + (((N3)+1)*(i-1)));
% end
% %disp(G);
% Z1 = zeros(N1+1,1);
% 
% for i=1:N1+1
% Z1(i) = 1 - tanh ((x1(i)-(1))/(2*sig));
% 
% end
% plot(x1,G1,'rx-')
% hold on
% plot(x2,G2,'rx-')
% hold on
% plot(x3,G3,'rx-')
% hold on
% plot(x4,G4,'rx-')
% hold on
% plot(x5,G5,'rx-')
% hold on
% plot(x6,G6,'rx-')
% hold on
% plot(x1,G7,'rx-')
% hold on
% plot(x2,G8,'rx-')
% hold on
% plot(x3,G9,'rx-')
% hold on
% plot(x4,G10,'rx-')
% hold on
% plot(x5,G11,'rx-')
% hold on
% plot(x6,G12,'rx-')
% hold on
% plot(x1,G13,'rx-')
% hold on
% plot(x2,G14,'rx-')
% hold on
% plot(x3,G15,'rx-')
% hold on
% plot(x4,G16,'rx-')
% hold on
% plot(x5,G17,'rx-')
% hold on
% plot(x6,G18,'rx-')
% hold on
% plot(x1,Z1,'gx-')

% for i=1:N1+1
% G1(i) = U1(((N1)+1) + (((N1*2)+1)*(i-1)));
% G4(i) = U4(((N1/2)+1) + (((N1)+1)*(i-1)));
% G7(i) = U7(((N1)+1) + (((N1*2)+1)*(i-1)));
% G10(i) = U10((((N1/2)+1)) + (((N1)+1)*(i-1)));
% G13(i) = U13(((N1)+1) + (((N1*2)+1)*(i-1)));
% G16(i) = U16((((N1/2)+1)) + (((N1)+1)*(i-1)));
% end
% for i=1:N2+1
% G2(i) = U2(((N2)+1) + (((N2*2)+1)*(i-1)));
% G5(i) = U5((((N2/2)+1)) + (((N2)+1)*(i-1)));
% G8(i) = U8(((N2)+1) + (((N2*2)+1)*(i-1)));
% G11(i) = U11((((N2/2)+1)) + (((N2)+1)*(i-1)));
% G14(i) = U14(((N2)+1) + (((N2*2)+1)*(i-1)));
% G17(i) = U17((((N2/2)+1)) + (((N2)+1)*(i-1)));
% end
% for i=1:N3+1
% G3(i) = U3(((N3)+1) + (((N3*2)+1)*(i-1)));
% G6(i) = U6((((N3/2)+1)) + (((N3)+1)*(i-1)));
% G9(i) = U9(((N3)+1) + (((N3*2)+1)*(i-1)));
% G12(i) = U12((((N3/2)+1)) + (((N3)+1)*(i-1)));
% G15(i) = U15(((N3)+1) + (((N3*2)+1)*(i-1)));
% G18(i) = U18((((N3/2)+1)) + (((N3)+1)*(i-1)));
% end
% %disp(G);
% Z1 = zeros(N1+1,1);
% Z2 = zeros(N2+1,1);
% Z3 = zeros(N3+1,1);
% Z4 = zeros(N1+1,1);
% Z5 = zeros(N2+1,1);
% Z6 = zeros(N3+1,1);

% for i=1:N1+1
% Z1(i) = 1 - tanh ((x1(i)-(0))/(2*sig));
% G1(i) = U1((1) + (((N1*2)+1)*(i-1))) ;
% end
% for i=1:N2+1
% Z1(i) = 1 - tanh ((x1(i)-(0))/(2*sig));
% end
% for i=1:N3+1
% Z1(i) = 1 - tanh ((x1(i)-(0))/(2*sig));
% end

% plot(x1,G1,'rx-')
% hold on
% plot(x1,Z1,'gx-')



% %------------------Error Plot----------------------%
% Z1 = zeros(3,1);
% Z2 = zeros(3,1);
% Z3 = zeros(3,1);
% Z4 = zeros(3,1);
% Z5 = zeros(3,1);
% Z6 = zeros(3,1);
% dx = zeros(3,1);
% dx(1) = 0.01;
% dx(2) = 0.02;
% dx(3) = 0.05;
% %
% for j=1:N1-1
% U1((N1*2 + 1) + (N1*2 + 1)*j) = U1((N1*2 + 1) + (N1*2 + 1)*j)+S1(j);
% U7((N1*2 + 1) + (N1*2 + 1)*j) = U7((N1*2 + 1) + (N1*2 + 1)*j)+S1(j);
% U13((N1*2 + 1) + (N1*2 + 1)*j) = U13((N1*2 + 1) + (N1*2 + 1)*j)+S1(j);
% end
% for j=1:N2-1
% U2((N2*2 + 1) + (N2*2 + 1)*j) = U2((N2*2 + 1) + (N2*2 + 1)*j)+S2(j);
% U8((N2*2 + 1) + (N2*2 + 1)*j) = U8((N2*2 + 1) + (N2*2 + 1)*j)+S2(j);
% U14((N2*2 + 1) + (N2*2 + 1)*j) = U14((N2*2 + 1) + (N2*2 + 1)*j)+S2(j);
% end
% for j=1:N3-1
% U3((N3*2 + 1) + (N3*2 + 1)*j) = U3((N3*2 + 1) + (N3*2 + 1)*j)+S3(j);
% U9((N3*2 + 1) + (N3*2 + 1)*j) = U9((N3*2 + 1) + (N3*2 + 1)*j)+S3(j);
% U15((N3*2 + 1) + (N3*2 + 1)*j) = U15((N3*2 + 1) + (N3*2 + 1)*j)+S3(j);
% end
% for j=1:N4-1
% U4((N4 + 1) + (N4 + 1)*j) = U4((N4 + 1) + (N4 + 1)*j)+S4(j);
% U10((N4 + 1) + (N4 + 1)*j) = U10((N4 + 1) + (N4 + 1)*j)+S4(j);
% U16((N4 + 1) + (N4 + 1)*j) = U16((N4 + 1) + (N4 + 1)*j)+S4(j);
% end
% for j=1:N5-1
% U5((N5 + 1) + (N5 + 1)*j) = U5((N5 + 1) + (N5 + 1)*j)+S5(j);
% U11((N5 + 1) + (N5 + 1)*j) = U11((N5 + 1) + (N5 + 1)*j)+S5(j);
% U17((N5 + 1) + (N5 + 1)*j) = U17((N5 + 1) + (N5 + 1)*j)+S5(j);
% end
% for j=1:N6-1
% U6((N6 + 1) + (N6 + 1)*j) = U6((N6 + 1) + (N6 + 1)*j)+S6(j);
% U12((N6 + 1) + (N6 + 1)*j) = U12((N6 + 1) + (N6 + 1)*j)+S6(j);
% U18((N6 + 1) + (N6 + 1)*j) = U18((N6 + 1) + (N6 + 1)*j)+S6(j);
% end
% for i=1:N1+1
% G1(i)  = U1((N1*2 + 1) + (N1*2 + 1)*(i-1))  - ( 1 - tanh ((x1(i)-(1))/(2*sig)));
% G7(i)  = U7((N1*2 + 1) + (N1*2 + 1)*(i-1))  - ( 1 - tanh ((x1(i)-(1))/(2*sig)));
% G13(i) = U13((N1*2 + 1) + (N1*2 + 1)*(i-1)) - ( 1 - tanh ((x1(i)-(1))/(2*sig)));
% G4(i)  = U4((N1 + 1) + (N1 + 1)*(i-1))  - ( 1 - tanh ((x4(i)-(1))/(2*sig)));
% G10(i)  = U10((N1 + 1) + (N1 + 1)*(i-1))  - ( 1 - tanh ((x4(i)-(1))/(2*sig)));
% G16(i) = U16((N1 + 1) + (N1 + 1)*(i-1)) - ( 1 - tanh ((x4(i)-(1))/(2*sig)));
% end
% for i=1:N2+1
% G2(i)  = U2((N2*2 + 1) + (N2*2 + 1)*(i-1))  - ( 1 - tanh ((x2(i)-(1))/(2*sig)));
% G8(i)  = U8((N2*2 + 1) + (N2*2 + 1)*(i-1))  - ( 1 - tanh ((x2(i)-(1))/(2*sig)));
% G14(i) = U14((N2*2 + 1) + (N2*2 + 1)*(i-1)) - ( 1 - tanh ((x2(i)-(1))/(2*sig)));
% G5(i)  = U5((N2 + 1) + (N2 + 1)*(i-1))  - ( 1 - tanh ((x5(i)-(1))/(2*sig)));
% G11(i)  = U11((N2 + 1) + (N2 + 1)*(i-1))  - ( 1 - tanh ((x5(i)-(1))/(2*sig)));
% G17(i) = U17((N2 + 1) + (N2 + 1)*(i-1)) - ( 1 - tanh ((x5(i)-(1))/(2*sig)));
% end
% for i=1:N3+1
% G3(i)  = U3((N3*2 + 1) + (N3*2 + 1)*(i-1))  - ( 1 - tanh ((x3(i)-(1))/(2*sig)));
% G9(i)  = U9((N3*2 + 1) + (N3*2 + 1)*(i-1))  - ( 1 - tanh ((x3(i)-(1))/(2*sig)));
% G15(i) = U15((N3*2 + 1) + (N3*2 + 1)*(i-1)) - ( 1 - tanh ((x3(i)-(1))/(2*sig)));
% G6(i)  = U6((N3 + 1) + (N3 + 1)*(i-1))  - ( 1 - tanh ((x6(i)-(1))/(2*sig)));
% G12(i)  = U12((N3 + 1) + (N3 + 1)*(i-1))  - ( 1 - tanh ((x6(i)-(1))/(2*sig)));
% G18(i) = U18((N3 + 1) + (N3 + 1)*(i-1)) - ( 1 - tanh ((x6(i)-(1))/(2*sig)));
% end
% Z1(1) = norm(G3,2);
% Z1(2) = norm(G2,2);
% Z1(3) = norm(G1,2);
% Z2(1) = norm(G6,2);
% Z2(2) = norm(G5,2)-1.4;
% Z2(3) = norm(G4,2)-1;
% Z3(1) = norm(G9,2);
% Z3(2) = norm(G8,2);
% Z3(3) = norm(G7,2);
% Z4(1) = norm(G12,2);
% Z4(2) = norm(G11,2);
% Z4(3) = norm(G10,2);
% Z5(1) = norm(G15,2);
% Z5(2) = norm(G14,2);
% Z5(3) = norm(G13,2);
% Z6(1) = norm(G18,2);
% Z6(2) = norm(G17,2);
% Z6(3) = norm(G16,2);
% plot(dx,Z1,'rx-',dx,Z2,'gx-',dx,Z3,'yx-',dx,Z4,'bx-',dx,Z5,'bx-',dx,Z6,'mx-');
% legend('P = 0 Ratio = 0.5','P = 0 Ratio = 1','P = 2/3 Ratio = 0.5','P = 2/3 Ratio = 1','P = 1 Ratio = 0.5','P = 1 Ratio = 1');
%------------------Error Plot End----------------------%
% hold on
% plot(dx,Z2,'gx-');
% legend('P = 0 Ratio = 1');
% hold on
% plot(dx,Z3,'yx-');
% legend('P = 2/3 Ratio = 0.5');
% hold on
% plot(dx,Z4,'bx-');
% legend('P = 2/3 Ratio = 1');
% hold on
% plot(dx,Z5,'bx-');
% legend('P = 1 Ratio = 0.5');
% hold on
% plot(dx,Z6,'mx-');
% legend('P = 1 Ratio = 1');
% for k=1:(N1/2 - 1)
% U1((N1 + 1) + (N1*2 + 1)*k) = U1((N1 + 1) + (N1*2 + 1)*k)+S(k);
% U7((N1 + 1) + (N1*2 + 1)*k) = U7((N1 + 1) + (N1*2 + 1)*k)+S(k);
% U13((N1 + 1) + (N1*2 + 1)*k) = U13((N1 + 1) + (N1*2 + 1)*k)+S(k);
% end
% for i=1:N1+1
% Z1(i) = 1 - tanh ((x1(i)-(1))/(2*sig));
% G1(i) = U1(((N1*(1))+ 1) + (((N1*2)+1)*(i-1))) ;
% G7(i) = U7(((N1*(1))+ 1) + (((N1*2)+1)*(i-1))) ;
% G13(i) = U13(((N1*(1))+ 1) + (((N1*2)+1)*(i-1))) ;
% end
% for i=1:N1+1
% Z1(i) = 1 - tanh ((x1(i)-(1))/(2*sig));
% G1(i) = U1((N1*2 + 1) + (N1*2 + 1)*(i-1)) ;
% G7(i) = U7((N1*2 + 1) + (N1*2 + 1)*(i-1)) ;
% G13(i) = U13((N1*2 + 1) + (N1*2 + 1)*(i-1));
% end
% plot(x1,G1,'rx-')
% hold on
% plot(x1,Z1,'gx-')
% hold on
% plot(x1,G7,'rx-')
% hold on
% plot(x1,G13,'rx-')
% plot(x2,G2,'rx-')
% hold on
% plot(x3,G3,'rx-')
% hold on
% plot(x4,G4,'rx-')
% hold on
% plot(x5,G5,'rx-')
% hold on
% plot(x6,G6,'rx-')
% hold on
%  plot(x1,G7,'rx-')
%  hold on
% plot(x2,G8,'rx-')
% hold on
% plot(x3,G9,'rx-')
% hold on
% plot(x4,G10,'rx-')
% hold on
% plot(x5,G11,'rx-')
% hold on
% plot(x6,G12,'rx-')
% hold on
% plot(x1,G13,'rx-')
% hold on
% plot(x2,G14,'rx-')
% hold on
% plot(x3,G15,'rx-')
% hold on
% plot(x4,G16,'rx-')
% hold on
% plot(x5,G17,'rx-')
% hold on
% plot(x6,G18,'rx-')
% hold on
% plot(x1,Z1,'gx-')
% disp(Z1);
% disp(G1);
